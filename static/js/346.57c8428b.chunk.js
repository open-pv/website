"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[346],{6346:function(e,t,n){n.r(t),n.d(t,{default:function(){return pe}});var r=n(9439),a=n(2791),i=n(9230),o=n(9716),s=n.n(o),l=n(7762),u=n(4165),c=n(5861),d=n(3433),h=n(8351),f=n(6590),w=null,p=null,m=null,v=null;function g(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=document.getElementsByClassName("three-viewer")[0];t.style.width="100%",t.style.height="400px",p=new h.WebGLRenderer({antialias:!0,alpha:!0}),0!=e&&null!=m||((m=new h.PerspectiveCamera(45,t.clientWidth/t.clientHeight,1,1e3)).up=new h.Vector3(0,0,1)),p.setSize(t.clientWidth,t.clientHeight),t.replaceChild(p.domElement,t.firstChild),window.addEventListener("resize",(function(){p.setSize(t.clientWidth,t.clientHeight),m.aspect=t.clientWidth/t.clientHeight,m.updateProjectionMatrix()}),!1),(v=new f.o(m,p.domElement)).mouseButtons={LEFT:h.MOUSE.PAN,MIDDLE:h.MOUSE.DOLLY,RIGHT:h.MOUSE.ROTATE},v.screenSpacePanning=!1,v.maxPolarAngle=Math.PI/2,w=new h.Scene;var n=new h.DirectionalLight(16777215,.25);n.position.set(0,-.3,1),w.add(n);var r=new h.DirectionalLight(16777215,.1);r.position.set(.3,-.3,1),w.add(r);var a=new h.DirectionalLight(16777215,.1);a.position.set(-.3,-.3,1),w.add(a),w.add(new h.AmbientLight(16777215,1))}var x=n(6397);function y(e){var t=(0,r.Z)(e,3),n=t[0],a=t[1],i=t[2],o=x.clone(n),s=x.clone(a),l=x.clone(i);return x.lerp(o,n,a,.5),x.lerp(s,a,i,.5),x.lerp(l,i,n,.5),[[n,o,l],[a,s,o],[i,l,s],[o,s,l]]}function b(e,t){var n,r=[],a=(0,l.Z)(e);try{for(a.s();!(n=a.n()).done;)for(var i=[n.value];i.length>0;){var o=i.pop(),s=x.create(),u=x.create();x.sub(s,o[1],o[0]),x.sub(u,o[2],o[0]);var c=x.create();x.cross(c,s,u);var h,f,w=.5*x.len(c);if(h=x.dot(s,s),f=x.dot(u,u),w<=t&&Math.max(h,f)<=1)r.push(o);else{var p=y(o);i.push.apply(i,(0,d.Z)(p))}}}catch(m){a.e(m)}finally{a.f()}return r}var S=n(3365),A=n.n(S);function E(e,t){for(var n=0;n<e.length;n++)e[n]+=t[n]}function F(e){var t=[.2777273272234177,.005407344544966578,.3340998053353061],n=[.1050930431085774,1.404613529898575,1.384590162594685],r=[-.3308618287255563,.214847559468213,.09509516302823659],a=[-4.634230498983486,-5.799100973351585,-19.33244095627987],i=[6.228269936347081,14.17993336680509,56.69055260068105],o=[4.776384997670288,-13.74514537774601,-65.35303263337234],s=[-5.435455855934631,4.645852612178535,26.3124352495832];return[t[0]+e*(n[0]+e*(r[0]+e*(a[0]+e*(i[0]+e*(o[0]+e*s[0]))))),t[1]+e*(n[1]+e*(r[1]+e*(a[1]+e*(i[1]+e*(o[1]+e*s[1]))))),t[2]+e*(n[2]+e*(r[2]+e*(a[2]+e*(i[2]+e*(o[2]+e*s[2])))))]}function T(e,t,n,r,a){var i=t.length/9,o=e.length/3,s=document.getElementById("canvas").getContext("webgl2");s||alert("Your browser does not support WebGL2");var l="#version 300 es\n\t#define INFINITY         1000000.0\n\tprecision highp float;\n\n\n\tuniform sampler2D u_triangles;\n\tuniform vec3 u_sun_direction;\n  \tuniform int textureWidth;\n\n\tin vec3 a_position;\n\tin vec3 a_normal;\n\n\tout vec4 outColor;\n\n\tvec3 cross1(vec3 a, vec3 b) {\n\t\tvec3 c = vec3(0, 0, 0);\n\t\tc.x = a[1] * b[2] - a[2] * b[1];\n\t\tc.y = a[2] * b[0] - a[0] * b[2];\n\t\tc.z = a[0] * b[1] - a[1] * b[0];\n\t\treturn c;\n\t}\n\n\tfloat TriangleIntersect( vec3 v0, vec3 v1, vec3 v2, vec3 rayOrigin, vec3 rayDirection, int isDoubleSided )\n\t{\n\t\tvec3 edge1 = v1 - v0;\n\t\tvec3 edge2 = v2 - v0;\n\n\t\tvec3 pvec = cross(rayDirection, edge2);\n\n\t\tfloat epsilon = 0.000001; // Add epsilon to avoid division by zero\n\t\tfloat det = dot(edge1, pvec);\n\t\tif (abs(det) < epsilon) // Check if det is too close to zero\n\t\t\treturn INFINITY;\n\n\t\tfloat inv_det = 1.0 / det;\n\t\tif ( isDoubleSided == 0 && det < 0.0 ) \n\t\t\treturn INFINITY;\n\t\t\n\t\tvec3 tvec = rayOrigin - v0;\n\t\tfloat u = dot(tvec, pvec) * inv_det;\n\t\tvec3 qvec = cross(tvec, edge1);\n\t\tfloat v = dot(rayDirection, qvec) * inv_det;\n\t\tfloat t = dot(edge2, qvec) * inv_det;\n\t\tfloat x = dot(pvec,pvec);\n\t\treturn (u < 0.0 || u > 1.0 || v < 0.0 || u + v > 1.0 || t <= 0.0) ? INFINITY : t;\n\n\t}\n\n\n\tbool Calculate_Shading_at_Point(vec3 vertex_position, vec3 sun_direction) {\n\t\tfloat d;\n\t\tfloat t = INFINITY;\n\t\tbool is_shadowed = false;\n\t\tfor (int i = 0; i < ".concat(i,"; i++) {\n\t\t\tint index = i * 3;\n\t\t\tint x = index % textureWidth;\n\t\t\tint y = index / textureWidth;\n\t\t\tvec3 v0 = texelFetch(u_triangles, ivec2(x, y), 0).rgb;\n\n\t\t\tindex = i * 3 + 1;\n\t\t\tx = index % textureWidth;\n\t\t\ty = index / textureWidth;\n\t\t\tvec3 v1 = texelFetch(u_triangles, ivec2(x, y), 0).rgb;\n\n\t\t\tindex = i * 3 + 2;\n\t\t\tx = index % textureWidth;\n\t\t\ty = index / textureWidth;\n\t\t\tvec3 v2 = texelFetch(u_triangles, ivec2(x, y), 0).rgb;\n\t\t\td = TriangleIntersect(v0, v1, v2, vertex_position, sun_direction, 1);\n\t\t\tif (d < t && abs(d)>0.0001) {\n\t\t\t\treturn true;\n\n\t\t}\n\t\t}\n\t\treturn is_shadowed;\n\t}\n\n\tvoid main() {\n\t\tif (Calculate_Shading_at_Point(a_position.xyz, u_sun_direction)) {\n\t\t\t\t\toutColor = vec4(0, 0, 0, 0); // Shadowed\n\t\t\t\t} else {\n\t\t\t\t\tfloat intensity = abs(dot(a_normal.xyz, u_sun_direction));\n\t\t\t\t\toutColor = vec4(intensity, intensity, intensity, intensity); // Not shadowed\n\t\t\t\t}\n\n\t}"),u=R(s,s.VERTEX_SHADER,l),c=R(s,s.FRAGMENT_SHADER,"#version 300 es\n\tprecision highp float;\n\tvoid main() {\n\t}\n\t"),d=function(e,t,n,r){var a=e.createProgram();if(void 0===t||void 0===n)return window.setShowTooManyUniformsError(!0),"abortSimulation";if(e.attachShader(a,t),e.attachShader(a,n),e.transformFeedbackVaryings(a,r,e.SEPARATE_ATTRIBS),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS))return a;console.error(e.getProgramInfoLog(a)),e.deleteProgram(a)}(s,u,c,["outColor"]);if("abortSimulation"===d)return null;var h=s.createVertexArray();s.bindVertexArray(h);var f=s.getParameter(s.MAX_TEXTURE_SIZE),w=Math.min(3*i,9*Math.floor(f/9)),p=Math.ceil(3*i/w);console.log("Max Texture Size",f,w,p);var m=C(s,16*o),v=function(e,t){var n=e.createTransformFeedback();return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n),e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,0,t),n}(s,m);s.useProgram(d);var g,x=s.createTexture();if(s.bindTexture(s.TEXTURE_2D,x),1==p)g=t;else{g=new Float32Array(w*p*3);for(var y=0;y<3*i;y++)for(var b=3*y%w,S=Math.floor(3*y/w)*w+b,A=0;A<3;A++)g[S+A]=t[3*y+A]}s.texImage2D(s.TEXTURE_2D,0,s.RGB32F,w,p,0,s.RGB,s.FLOAT,g),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.bindTexture(s.TEXTURE_2D,null);var F=s.getUniformLocation(d,"u_triangles");s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,x),s.uniform1i(F,0);var T=s.getUniformLocation(d,"textureWidth");s.uniform1i(T,w);var L=s.getAttribLocation(d,"a_position"),k=s.getAttribLocation(d,"a_normal"),I=M(s,e,L),Z=M(s,n,k),N=null;for(y=0;y<r;y++){var D=s.getUniformLocation(d,"u_sun_direction"),P=j(1,a.lat,a.lon);s.uniform3fv(D,P),B(s,v,s.POINTS,o),null==N?N=_(s,m,"shading",o).filter((function(e,t){return(t+1)%4===0})):E(N,_(s,m,"shading",o).filter((function(e,t){return(t+1)%4===0})))}return s.deleteTexture(x),s.deleteShader(u),s.deleteShader(c),s.deleteProgram(d),s.deleteBuffer(I),s.deleteBuffer(Z),s.deleteTransformFeedback(v),s.deleteBuffer(m),N}function _(e,t,n,r){var a=new Float32Array(4*r);return e.bindBuffer(e.ARRAY_BUFFER,t),e.getBufferSubData(e.ARRAY_BUFFER,0,a),e.bindBuffer(e.ARRAY_BUFFER,null),a}function R(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;console.error(e.getShaderInfoLog(r)),e.deleteShader(r)}function C(e,t){var n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,t,e.DYNAMIC_DRAW),n}function M(e,t,n){C(e,t);e.enableVertexAttribArray(n),e.vertexAttribPointer(n,3,e.FLOAT,!1,0,0)}function B(e,t,n,r){e.enable(e.RASTERIZER_DISCARD),e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,t),e.beginTransformFeedback(e.POINTS),e.drawArrays(n,0,r),e.endTransformFeedback(),e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,0,null),e.disable(e.RASTERIZER_DISCARD)}var L,k,I;n(720);function j(e,t,n){for(var r=new Float32Array(3*e),a=0;a<e;){var i=new Date(2023,Math.floor(12*Math.random()),1+Math.floor(28*Math.random()),Math.floor(24*Math.random()),Math.floor(60*Math.random()),0,0),o=A().getPosition(i,t,n);o.altitude<.1||o.altitude==Number.NaN||(r[3*a]=-Math.cos(o.altitude)*Math.sin(o.azimuth),r[3*a+1]=-Math.cos(o.altitude)*Math.cos(o.azimuth),r[3*a+2]=Math.sin(o.altitude),a+=1)}return r}function Z(e,t){return N.apply(this,arguments)}function N(){return N=(0,c.Z)((0,u.Z)().mark((function e(t,n){var r,a,i,o,s,l,c,d,h,f,w,p,m,v,g,x,y,b,S,A,E;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=L.attributes.position.array,a=k.attributes.position.array,i=k.attributes.normal.array,(o=document.getElementById("status")).textContent="Simulating",o.hasChanged=!0,s=[],l=[],c={},d=0;d<a.length;d+=3)h=[a[d],a[d+1],a[d+2]].map((function(e){return parseFloat(e.toFixed(6))})),f=JSON.stringify(h),c.hasOwnProperty(f)||(c[f]=d/3,s.push(a[d],a[d+1],a[d+2]),l.push(i[d],i[d+1],i[d+2]));return w=new Float32Array(s.slice()),p=new Float32Array(l.slice()),e.next=14,T(w,r,p,window.numSimulations,t);case 14:if(null!==(m=e.sent)){e.next=18;break}return window.setLoading(!1),e.abrupt("return",null);case 18:for(v=0;v<m.length;v++)g=[s[3*v],s[3*v+1],s[3*v+2]].map((function(e){return parseFloat(e.toFixed(6))})),x=JSON.stringify(g),c.hasOwnProperty(x)?c[x]=m[v]:console.error("Couldn't find indices for pointKey ".concat(x));for(y=new Array(a.length/3).fill(0),b=0;b<a.length;b+=3)S=[a[b],a[b+1],a[b+2]].map((function(e){return parseFloat(e.toFixed(6))})),A=JSON.stringify(S),c.hasOwnProperty(A)&&(y[b/3]=c[A]);E=new Float32Array(y),o.textContent="Simulation Done",o.hasChanged=!0,window.setLoading(!1),z(E,n);case 26:case"end":return e.stop()}}),e)}))),N.apply(this,arguments)}function D(e,t){var n,r=b([[x.fromValues.apply(x,(0,d.Z)(e.slice(0,3))),x.fromValues.apply(x,(0,d.Z)(e.slice(3,6))),x.fromValues.apply(x,(0,d.Z)(e.slice(6,9)))]],t),a=[],i=(0,l.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push.apply(a,(0,d.Z)(o))}}catch(s){i.e(s)}finally{i.f()}return a}function P(e,t){for(var n=e.attributes.position.array.slice(),r=[],a=[],i=0;i<n.length;i+=9){for(var o=!0,s=0;s<9;s+=3)(n[i+s]<-t||n[i+s]>t||n[i+s+1]<-t||n[i+s+1]>t)&&(o=!1);if(o){var l=x.fromValues.apply(x,(0,d.Z)(n.slice(i,i+3))),u=x.fromValues.apply(x,(0,d.Z)(n.slice(i+3,i+6))),c=x.fromValues.apply(x,(0,d.Z)(n.slice(i+6,i+9))),f=x.create();x.sub(f,u,l);var w=x.create();x.sub(w,c,l);var p=x.create();x.cross(p,f,w);var m=x.create();if(x.scale(m,p,1/x.len(p)),x.len(p)<.05)continue;for(s=0;s<9;s++)r.push(n[i+s]),a.push(m[s%3])}}var v=new h.BufferGeometry;return v.setAttribute("position",new h.BufferAttribute(new Float32Array(r),3)),v.setAttribute("normal",new h.BufferAttribute(new Float32Array(a),3)),v.attributes.position.needsUpdate=!0,v.attributes.normal.needsUpdate=!0,v}function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.numRadiusSimulation+20,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.numRadiusSimulation+70,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:window.numRadiusSimulation,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;null,function(e,t){for(var n=Number.POSITIVE_INFINITY,r=0;r<e.attributes.position.array.length;r++){var a=e.attributes.position.getZ(r);a<n&&(n=a)}var i=e.attributes.position.array;for(r=0;r<i.length;r+=9)for(var o=0;o<9;o+=3)i[r+o]=i[r+o]-t[0],i[r+o+1]=i[r+o+1]-t[1],i[r+o+2]=i[r+o+2]-n}(e,[V[0]-t[0],V[1]-t[1]]),L=P(e,n);var o=function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Number.POSITIVE_INFINITY,a=P(e,n).attributes.position.array.slice(),i=[],o=[],s=[],u=[],c=0;c<a.length;c+=9){for(var f=!0,w=0;w<9;w+=3)(a[c+w]<-t||a[c+w]>t||a[c+w+1]<-t||a[c+w+1]>t)&&(f=!1);var p=x.fromValues.apply(x,(0,d.Z)(a.slice(c,c+3))),m=x.fromValues.apply(x,(0,d.Z)(a.slice(c+3,c+6))),v=x.fromValues.apply(x,(0,d.Z)(a.slice(c+6,c+9))),g=x.create();x.sub(g,m,p);var y=x.create();x.sub(y,v,p);var b=x.create();x.cross(b,g,y);var S=x.create();if(x.scale(S,b,1/x.len(b)),!(x.len(b)<.05))if(f){var A,E=D(a.slice(c,c+9),r),F=(0,l.Z)(E);try{for(F.s();!(A=F.n()).done;){var T=A.value;i.push(T[0]),i.push(T[1]),i.push(T[2]),o.push(S[0]),o.push(S[1]),o.push(S[2])}}catch(C){F.e(C)}finally{F.f()}}else for(w=0;w<9;w++)s.push(a[c+w]),u.push(S[w%3])}var _=new h.BufferGeometry;_.setAttribute("position",new h.BufferAttribute(new Float32Array(i),3)),_.setAttribute("normal",new h.BufferAttribute(new Float32Array(o),3)),_.attributes.position.needsUpdate=!0,_.attributes.normal.needsUpdate=!0;var R=new h.BufferGeometry;return R.setAttribute("position",new h.BufferAttribute(new Float32Array(s),3)),R.setAttribute("normal",new h.BufferAttribute(new Float32Array(u),3)),R.attributes.position.needsUpdate=!0,R.attributes.normal.needsUpdate=!0,{innerGeometry:_,outerGeometry:R}}(e,a,r,i);k=o.innerGeometry,I=o.outerGeometry,0===k.attributes.position.array.length&&(window.setLoading(!1),window.setShowErrorMessage(!0),window.setShowThreeViewer(!1))}function z(e,t){return O.apply(this,arguments)}function O(){return O=(0,c.Z)((0,u.Z)().mark((function e(t,n){var r,a,i,o,s,l,c,d,f,x,y;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=n||null==m?{x:0,y:0,z:0}:{x:m.position.x,y:m.position.y,z:m.position.z},g(n),a=k.attributes.position.array.length/3,i=new Float32Array(3*a),o=0;o<a;o++)s=F(Math.min(1,t[o]/window.numSimulations/.6)),i[3*o]=s[0],i[3*o+1]=s[1],i[3*o+2]=s[2];k.setAttribute("color",new h.Float32BufferAttribute(i,3)),l=new h.MeshStandardMaterial({vertexColors:!0,side:h.DoubleSide,shininess:0,roughness:1}),c=new h.Mesh(k,l),w.add(c),d=new h.MeshStandardMaterial({vertexColors:!1,side:h.DoubleSide,color:13745828,shininess:0,roughness:1}),f=new h.Mesh(I,d),w.add(f),x=new h.Vector3,k.computeBoundingBox(),k.boundingBox.getCenter(x),Math.max(k.boundingBox.max.x,k.boundingBox.max.y,k.boundingBox.max.z),n?m.position.set(0,-40,80):m.position.set(r.x-window.offsetPos[0],r.y-window.offsetPos[1],r.z),y=function e(){requestAnimationFrame(e),v.update(),p.render(w,m)},window.setShowViridisLegend(!0),y();case 20:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}var V,G=n(5587),W=n.n(G),Y=n(9970),X=n(8615),q=n(7133);function H(e){return K.apply(this,arguments)}function K(){return(K=(0,c.Z)((0,u.Z)().mark((function e(t){var n,a,i,o,s,l,c,d;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!/^[-]?(\d+(\.\d+)?),\s*[-]?(\d+(\.\d+)?)$/.test(t)){e.next=7;break}return a=t.split(",").map((function(e){return parseFloat(e.trim())})),i=(0,r.Z)(a,2),o=i[0],s=i[1],n={lat:o,lon:s},e.abrupt("return",n);case 7:return l="https://nominatim.openstreetmap.org/search?format=json&q=".concat(t).concat("+Germany+Bavaria"),e.next=10,J(l);case 10:if(c=e.sent){e.next=17;break}return d=t.split(" ").join("+"),l="https://nominatim.openstreetmap.org/search?format=json&q=".concat(d),e.next=16,J(l);case 16:c=e.sent;case 17:return e.abrupt("return",c);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return $.apply(this,arguments)}function $(){return($=(0,c.Z)((0,u.Z)().mark((function e(t){var n,r,a,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.getElementById("status"),e.prev=1,e.next=4,fetch(t);case 4:if((a=e.sent).ok){e.next=9;break}throw console.error("Check connection to Nominatim geocoder"),r.textContent="Connection to Adress Server failed",new Error("Request failed with status "+a.status);case 9:return e.next=11,a.json();case 11:if(0!==(i=e.sent).length){e.next=14;break}return e.abrupt("return",null);case 14:return n=i[0],e.abrupt("return",n);case 18:return e.prev=18,e.t0=e.catch(1),console.error("Error:",e.t0),e.abrupt("return",null);case 22:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}function Q(e,t,n,r){return ee.apply(this,arguments)}function ee(){return(ee=(0,c.Z)((0,u.Z)().mark((function e(t,n,r,a){var i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.mapLocationBaseChanged=!0,!n){e.next=8;break}return e.next=4,H(t);case 4:i=e.sent,window.mapLocation=i,e.next=9;break;case 8:r||window.mapLocationChanged?i=a:window.setLoading(!1);case 9:"undefined"!==typeof i&&null!=i?ae(i,n):(window.setLoading(!1),window.setShowThreeViewer(!1),window.setShowErrorMessage(!0)),n&&(window.mapLocationChanged=!1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){var n=2e3,a=100;Y.Z.defs("EPSG:25832","+proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs");var i=(0,Y.Z)("EPSG:4326","EPSG:25832").forward([e,t]),o=(0,r.Z)(i,2),s=o[0],l=o[1];V=[s,l];var u=2*Math.floor(s/n),c=2*Math.floor(l/n),d=s%n<a,h=s%n>1900,f=l%n<a,w=l%n>1900,p=["".concat(u,"_").concat(c,".zip")];return d&&p.push("".concat(u-2,"_").concat(c,".zip")),h&&p.push("".concat(u+2,"_").concat(c,".zip")),f&&p.push("".concat(u,"_").concat(c-2,".zip")),w&&p.push("".concat(u,"_").concat(c+2,".zip")),d&&f&&p.push("".concat(u-2,"_").concat(c-2,".zip")),d&&w&&p.push("".concat(u-2,"_").concat(c+2,".zip")),h&&f&&p.push("".concat(u+2,"_").concat(c-2,".zip")),h&&w&&p.push("".concat(u+2,"_").concat(c+2,".zip")),p}function ne(e){for(var t=new Uint8Array(e),n=[],r=t.length-2;r>=0&&(10!==t[r]&&13!==t[r]);r--)n.unshift(String.fromCharCode(t[r]));var a=n.join("");return a=a.trim()}function re(e){var t=e.match(/^;\s*offset\s*(-?\d+(?:\.\d+)?(?:e[-+]?\d+)?)\s*(-?\d+(?:\.\d+)?(?:e[-+]?\d+)?)\s*(-?\d+(?:\.\d+)?(?:e[-+]?\d+)?)\s*$/i),n=[0,0,0];return t?(console.log("Matches",t),n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])],console.log("Offsets:",n[0],n[1],n[2])):console.log("Invalid comment format"),n}function ae(e){return ie.apply(this,arguments)}function ie(){return ie=(0,c.Z)((0,u.Z)().mark((function e(t){var n,r,a,i,o,s,c,d,h,f,w,p,m,v,g,x,y,b,S,A,E=arguments;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=E.length>1&&void 0!==E[1]&&E[1],r="https://www.openpv.de/data/",0!=(a=te(Number(t.lon),Number(t.lat))).length){e.next=5;break}return e.abrupt("return");case 5:i=document.getElementById("status"),o=[],s=null,c=!1,d=null,h=(0,l.Z)(a),e.prev=11,h.s();case 13:if((f=h.n()).done){e.next=65;break}if(w=f.value,p=void 0,-1==(p=null!=window.stlFile?window.stlFiles.indexOf(w):-1)){e.next=23;break}s=window.stlDataCached[p],c=!0,console.log("Use cached file!!"),e.next=43;break;case 23:return m=r+w,i.textContent="Loading from "+m,e.prev=25,v=void 0,e.next=29,fetch(m);case 29:if((v=e.sent).ok){e.next=32;break}throw new Error("Request failed with status "+v.status);case 32:return e.next=34,v.arrayBuffer();case 34:s=e.sent,c?(window.stlDataCached.append(s),window.stlFiles.append(w)):(window.stlDataCached=[s],window.stlFiles=[w]),e.next=43;break;case 38:return e.prev=38,e.t0=e.catch(25),window.setLoading(!1),window.setShowErrorMessage(!0),e.abrupt("return");case 43:return g=new(W()),e.next=46,g.loadAsync(s);case 46:if(!(x=g.file(Object.keys(g.files)[0]))){e.next=62;break}return e.next=50,x.async("arraybuffer");case 50:y=e.sent,stlDataCached=y,b=(new X.j).parse(y),S=ne(y),A=re(S),null==d?(d=A,A=[0,0,0]):(A=[A[0]-d[0],A[1]-d[1],A[2]-d[2]],b.translate(A[0],A[1],A[2])),o.push(b),U(q.n4(o),d),Z(t,n),e.next=63;break;case 62:console.error("STL file not found in ZIP archive");case 63:e.next=13;break;case 65:e.next=70;break;case 67:e.prev=67,e.t1=e.catch(11),h.e(e.t1);case 70:return e.prev=70,h.f(),e.finish(70);case 73:case"end":return e.stop()}}),e,null,[[11,67,70,73],[25,38]])}))),ie.apply(this,arguments)}var oe=n(184);var se=function(){return(0,oe.jsx)("div",{style:{alignItems:"center"},children:(0,oe.jsx)("p",{children:"Leider ist das ausgew\xe4hlte Gebiet zu gro\xdf, um auf deinem PC simuliert zu werden. Du kannst den Geb\xe4uderadius mit dem Slider auf der linken Seite kleiner stellen, um dieses Problem zu beheben."})})};var le=function(){return(0,oe.jsxs)("div",{style:{alignItems:"center"},children:[(0,oe.jsx)("p",{children:"Adresse wurde nicht gefunden oder liegt nicht innerhalb von Bayern. Leider k\xf6nnen wir aktuell nur H\xe4user in Bayern simulieren."}),(0,oe.jsx)("p",{children:"Alternativ kannst du auch die Koordinaten in Google Maps per Rechtsklick bestimmen und in das Suchfeld eingeben."}),(0,oe.jsx)("img",{src:"images/googleMaps.gif",alt:"Showing how to get coordinates from Google Maps",style:{width:"100%",maxWidth:"500px"}})]})},ue={display:"block",margin:"auto",borderColor:"red"};var ce=function(){var e=(0,a.useState)(""),t=(0,r.Z)(e,2),n=t[0],o=t[1],l=(0,a.useState)(!1),u=(0,r.Z)(l,2),c=u[0],d=u[1],h=(0,a.useState)(!1),f=(0,r.Z)(h,2),w=f[0],p=f[1],m=(0,a.useState)(!1),v=(0,r.Z)(m,2),g=v[0],x=v[1],y=(0,i.$G)(),b=y.t,S=(y.i18n,(0,a.useState)(!1)),A=(0,r.Z)(S,2),E=A[0],F=A[1];return window.setShowErrorMessage=p,window.setShowTooManyUniformsError=F,window.setLoading=d,(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("form",{onSubmit:function(e){g||window.numRadiusSimulationChanged||window.numSimulationsChanged||window.mapLocationChanged?(d(!c),window.setShowViridisLegend(!1),e.preventDefault(),window.setShowThreeViewer(!0),Q(n,g,window.numRadiusSimulationChanged||window.numSimulationsChanged,window.mapLocation),window.numRadiusSimulationChanged=!1,window.numSimulationsChanged=!1,window.mapLocationChanged=!1,p(!1),F(!1),x(!1)):e.preventDefault()},style:{display:"flex",alignItems:"center"},id:"search-field",children:[(0,oe.jsx)("input",{type:"text",placeholder:b("searchField.placeholder"),value:n,onChange:function(e){n!=e.target.value&&(o(e.target.value),x(!0))}}),(0,oe.jsx)("button",{type:"submit",children:"Start"})]}),w&&(0,oe.jsx)(le,{}),E&&(0,oe.jsx)(se,{}),(0,oe.jsx)(s(),{color:"MediumAquaMarine",cssOverride:ue,loading:c,size:60})]})},de=n(8740),he=n(4666);function fe(){var e=(0,a.useState)([0,0]),t=(0,r.Z)(e,2),n=t[0],i=t[1],o=(0,a.useState)(!1),s=(0,r.Z)(o,2),l=s[0],u=s[1];window.offsetPos=[0,0];var c=function(e,t){var r=[0,0];if(window.mapLocationBaseChanged?(i(0,0),r=[-n[0],-n[1]],window.mapLocationBaseChanged=!1):r=[0,0],null!=window.mapLocation){var a=window.distanceStep,o=Math.atan2(m.rotation.y,m.rotation.x),s={x:e*a*Math.cos(o)-t*a*Math.sin(o),y:t*a*Math.cos(o)+e*a*Math.sin(o)},l=[n[0]+s.x+r[0],n[1]+s.y+r[1]];window.offsetPos=l,i([l[0],l[1]]);var u={lon:window.mapLocation.lon,lat:window.mapLocation.lat},c={lon:parseFloat(u.lon),lat:parseFloat(u.lat)};c.lon+=360*s.x/4e7/Math.cos(c.lat/180*Math.PI),c.lat+=360*s.y/4e7,c={lat:c.lat.toString(),lon:c.lon.toString()},window.mapLocation=c,window.mapLocationChanged=!0,m.position.set(m.position.x+s.x,m.position.y+s.y,m.position.z),m.lookAt(l[0],l[1],0),v.target.set(l[0],l[1],0);!function e(){requestAnimationFrame(e),v.update(),p.render(w,m)}(),function(e){var t=new h.CylinderGeometry(.25,.25,100,32),n=new h.MeshBasicMaterial({color:8947848}),r=new h.Mesh(t,n);r.position.set(e[0],e[1],50),r.rotation.set(Math.PI/2,0,0),w.add(r),function e(){r.scale.y>.1?(r.scale.y*=.95,r.position.z=100*r.scale.y/2,n.color.lerp(new h.Color(12303291),.04),setTimeout(e,20)):(w.remove(r),r.geometry.dispose(),r.material.dispose())}()}(l)}};return(0,oe.jsxs)("div",{className:"viewer-container",style:{position:"relative"},children:[(0,oe.jsx)(he.Xz,{className:"three-viewer",flat:!0,linear:!0}),(0,oe.jsx)("canvas",{id:"canvas",width:0,height:0}),window.showViridisLegend&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("button",{className:"arrowButton",onClick:function(){return c(0,1)},style:{right:"1em",bottom:"2em"},children:(0,oe.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,oe.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),(0,oe.jsx)("polyline",{points:"5 12 12 5 19 12"})]})}),(0,oe.jsx)("button",{className:"arrowButton",onClick:function(){return c(0,-1)},style:{right:"1em",bottom:"0em"},children:(0,oe.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",style:{transform:"rotate(180deg)"},children:[(0,oe.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),(0,oe.jsx)("polyline",{points:"5 12 12 5 19 12"})]})}),(0,oe.jsx)("button",{className:"arrowButton",onClick:function(){u(!l),(window.numRadiusSimulationChanged||window.numSimulationsChanged||window.mapLocationChanged)&&(window.setShowViridisLegend(!1),window.setShowThreeViewer(!0),Q("",!1,window.numRadiusSimulationChanged||window.numSimulationsChanged,window.mapLocation),window.numRadiusSimulationChanged=!1,window.numSimulationsChanged=!1,window.mapLocationChanged=!1)},style:{right:"1em",bottom:"1em"},children:(0,oe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 50 50",children:(0,oe.jsx)("polyline",{points:"10,25 20,35 40,15",stroke:"#000000",strokeWidth:"0.5em",fill:"none"})})}),(0,oe.jsx)("button",{className:"arrowButton",onClick:function(){return c(-1,0)},style:{right:"2em",bottom:"1em"},children:(0,oe.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",style:{transform:"rotate(270deg)"},children:[(0,oe.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),(0,oe.jsx)("polyline",{points:"5 12 12 5 19 12"})]})}),(0,oe.jsx)("button",{className:"arrowButton",onClick:function(){return c(1,0)},style:{right:"0em",bottom:"1em"},children:(0,oe.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",style:{transform:"rotate(90deg)"},children:[(0,oe.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),(0,oe.jsx)("polyline",{points:"5 12 12 5 19 12"})]})})]})]})}var we=function(){return(0,oe.jsx)("img",{src:"images/viridis_legend.svg",alt:"Legend of the viridis colormap",style:{opacity:.6},width:"100%"})};var pe=function(){var e=(0,a.useState)(!0),t=(0,r.Z)(e,2),n=t[0],i=t[1],o=(0,a.useState)(!1),s=(0,r.Z)(o,2),l=s[0],u=s[1];return window.setShowThreeViewer=i,window.setShowViridisLegend=u,window.showViridisLegend=l,(0,oe.jsx)(de.Z,{description:"Berechne das Potential deiner Solaranlage.",children:(0,oe.jsxs)("article",{className:"post",id:"index",children:[(0,oe.jsx)("header",{children:(0,oe.jsx)("div",{className:"title",children:(0,oe.jsx)(ce,{})})}),n&&(0,oe.jsx)(fe,{}),l&&(0,oe.jsx)(we,{})]})})}}}]);
//# sourceMappingURL=346.57c8428b.chunk.js.map