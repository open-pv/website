{"version":3,"file":"static/js/994.51e9cf52.chunk.js","mappings":"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","sources":["simulation/stl_to_array.js","simulation/stlviewer.js","simulation/utils.js","simulation/webgl_raytracing_points.js","simulation/pv_simulation.js","simulation/download.js","simulation/lazimport.js","components/ErrorMessages/TooManyUniforms.js","components/ErrorMessages/WrongAdress.js","components/PVSimulation/SearchField.js","components/ThreeViewer/ThreeViewer.js","components/ThreeViewer/ViridisLegend.js","pages/Index.js"],"sourcesContent":["import { vec3 } from \"gl-matrix\"\n// const { vec3, mat4 } = glMatrix;\n\nexport function loadSTL(model) {\n  return new Promise((resolve, reject) => {\n    new THREE.STLLoader().load(\n      model,\n      function (geometry) {\n        // Extract the position and normal arrays from the geometry\n        const positionArray = geometry.attributes.position.array\n        //const normalArray = geometry.attributes.normal.array;\n\n        const triangles = []\n\n        for (let i = 0; i < positionArray.length; i += 9) {\n          const triangle = [\n            Array.from(positionArray.slice(i, i + 3)),\n            Array.from(positionArray.slice(i + 3, i + 6)),\n            Array.from(positionArray.slice(i + 6, i + 9)),\n          ]\n\n          triangles.push(triangle.map((v) => vec3.fromValues(...v)))\n        }\n\n        const threshold = 0.1 // Set your desired threshold value here\n        const subdividedTriangles = adaptiveSubdivideMesh(triangles, threshold)\n\n        // Return the arrays in an object\n        resolve({\n          original_vertices: positionArray,\n          subdivided_triangles: subdividedTriangles,\n        })\n      },\n      undefined,\n      reject\n    )\n  })\n}\n\nexport function subdivideTriangle(triangle) {\n  const [v0, v1, v2] = triangle\n\n  const m01 = vec3.clone(v0)\n  const m12 = vec3.clone(v1)\n  const m20 = vec3.clone(v2)\n\n  vec3.lerp(m01, v0, v1, 0.5)\n  vec3.lerp(m12, v1, v2, 0.5)\n  vec3.lerp(m20, v2, v0, 0.5)\n\n  return [\n    [v0, m01, m20],\n    [v1, m12, m01],\n    [v2, m20, m12],\n    [m01, m12, m20],\n  ]\n}\n\nexport function adaptiveSubdivideMesh(triangles, threshold) {\n  const subdividedTrianglesList = []\n\n  for (const triangle of triangles) {\n    let trianglesToSubdivide = [triangle]\n\n    while (trianglesToSubdivide.length > 0) {\n      const currentTriangle = trianglesToSubdivide.pop()\n\n      const edge1 = vec3.create()\n      const edge2 = vec3.create()\n\n      vec3.sub(edge1, currentTriangle[1], currentTriangle[0])\n      vec3.sub(edge2, currentTriangle[2], currentTriangle[0])\n\n      const crossProduct = vec3.create()\n      vec3.cross(crossProduct, edge1, edge2)\n      const area = 0.5 * vec3.len(crossProduct)\n\n      let lengthEdge1\n      let lengthEdge2\n\n      lengthEdge1 = vec3.dot(edge1, edge1)\n      lengthEdge2 = vec3.dot(edge2, edge2)\n\n      if (area <= threshold && Math.max(lengthEdge1, lengthEdge2) <= 1) {\n        subdividedTrianglesList.push(currentTriangle)\n      } else {\n        const subdividedTriangles = subdivideTriangle(currentTriangle)\n        trianglesToSubdivide.push(...subdividedTriangles)\n      }\n    }\n  }\n\n  return subdividedTrianglesList\n}\n","import * as THREE from \"three\"\nimport { MapControls } from \"three/addons/controls/MapControls.js\"\n\nexport var scene = null\nexport var renderer = null\nexport var camera = null\nexport var controls = null\n\nexport function STLViewerEnable(classname) {\n  var model = document.getElementsByClassName(classname)[0]\n  STLViewer(model)\n}\n\nexport function STLViewer(resetCamera = true) {\n  const elem = document.getElementsByClassName(\"three-viewer\")[0]\n\n  elem.style.width = \"100%\"\n  elem.style.height = \"400px\"\n\n  renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true })\n\n  //   if (camera != null) {\n  //     console.log(\"ResetCamera\", resetCamera);\n  //     console.log(\"CameraPos\", camera.position);\n  //     console.log(\"CameraRotation\", camera.rotation);\n  //   }\n  if (resetCamera == false || camera == null) {\n    camera = new THREE.PerspectiveCamera(\n      45,\n      elem.clientWidth / elem.clientHeight,\n      1,\n      1000\n    )\n    camera.up = new THREE.Vector3(0, 0, 1)\n  }\n  renderer.setSize(elem.clientWidth, elem.clientHeight)\n  elem.replaceChild(renderer.domElement, elem.firstChild)\n\n  window.addEventListener(\n    \"resize\",\n    function () {\n      renderer.setSize(elem.clientWidth, elem.clientHeight)\n      camera.aspect = elem.clientWidth / elem.clientHeight\n      camera.updateProjectionMatrix()\n    },\n    false\n  )\n\n  controls = new MapControls(camera, renderer.domElement)\n  controls.mouseButtons = {\n    LEFT: THREE.MOUSE.PAN,\n    MIDDLE: THREE.MOUSE.DOLLY,\n    RIGHT: THREE.MOUSE.ROTATE,\n  }\n  controls.screenSpacePanning = false\n  controls.maxPolarAngle = Math.PI / 2\n\n  scene = new THREE.Scene()\n\n  let dirLight = new THREE.DirectionalLight(0xffffff, 0.25)\n  dirLight.position.set(0, -0.3, 1)\n  scene.add(dirLight)\n\n  let dirLight2 = new THREE.DirectionalLight(0xffffff, 0.1)\n  dirLight2.position.set(0.3, -0.3, 1)\n  scene.add(dirLight2)\n\n  let dirLight3 = new THREE.DirectionalLight(0xffffff, 0.1)\n  dirLight3.position.set(-0.3, -0.3, 1)\n  scene.add(dirLight3)\n  scene.add(new THREE.AmbientLight(0xffffff, 1))\n}\n","export function addToArray(ar1, ar2) {\n  for (var i = 0; i < ar1.length; i++) {\n    ar1[i] += ar2[i]\n  }\n}\n\n// from https://observablehq.com/@flimsyhat/webgl-color-maps\nexport function intensity_colormap(t) {\n  //viridis\n  const c0 = [0.2777273272234177, 0.005407344544966578, 0.3340998053353061]\n  const c1 = [0.1050930431085774, 1.404613529898575, 1.384590162594685]\n  const c2 = [-0.3308618287255563, 0.214847559468213, 0.09509516302823659]\n  const c3 = [-4.634230498983486, -5.799100973351585, -19.33244095627987]\n  const c4 = [6.228269936347081, 14.17993336680509, 56.69055260068105]\n  const c5 = [4.776384997670288, -13.74514537774601, -65.35303263337234]\n  const c6 = [-5.435455855934631, 4.645852612178535, 26.3124352495832]\n\n  //const res = c0*0.004+t*(c1+t*(c2+t*(c3+t*(c4+t*(c5+t*c6)))))*0.004;\n  const res = [\n    c0[0] +\n      t *\n        (c1[0] +\n          t * (c2[0] + t * (c3[0] + t * (c4[0] + t * (c5[0] + t * c6[0]))))),\n    c0[1] +\n      t *\n        (c1[1] +\n          t * (c2[1] + t * (c3[1] + t * (c4[1] + t * (c5[1] + t * c6[1]))))),\n    c0[2] +\n      t *\n        (c1[2] +\n          t * (c2[2] + t * (c3[2] + t * (c4[2] + t * (c5[2] + t * c6[2]))))),\n  ]\n  return res\n}\n\nexport function deleteChildDivs(parentDivClass) {\n  let parentDiv = document.getElementsByClassName(parentDivClass)\n  for (var i = 0; i < parentDiv.length; i++) {\n    let div = parentDiv[i]\n\n    // Remove all child elements by setting innerHTML to an empty string\n    div.innerHTML = \"\"\n  }\n}\n","import { retrieveRandomSunDirections } from \"./pv_simulation\"\nimport { addToArray } from \"./utils\"\n\nfunction max_subdim(array, offset, iterate = 3) {\n  var max = -1000000\n  for (var i = offset; i < array.length; i += iterate) {\n    max = Math.max(array[i], max)\n  }\n  return max\n}\n\nfunction min_subdim(array, offset, iterate = 3) {\n  var min = 1000000\n  for (var i = offset; i < array.length; i += iterate) {\n    min = Math.min(array[i], min)\n  }\n  return min\n}\n\nexport function rayTracingPointsWebGL(\n  pointsArray,\n  trianglesArray,\n  normals,\n  laserPoints,\n  laserPointsRadius,\n  laserPointsMinDistance,\n  num_dates,\n  loc\n) {\n  const N_TRIANGLES = trianglesArray.length / 9\n  const width = pointsArray.length / 3 // Change this to the number of horizontal points in the grid\n  const N_POINTS = width\n  const canvas = document.getElementById(\"canvas\")\n\n  //canvas.width = width;\n  //canvas.height = height;\n\n  const gl = canvas.getContext(\"webgl2\")\n\n  if (!gl) {\n    alert(\"Your browser does not support WebGL2\")\n  }\n\n  // Vertex shader code\n  const vertexShaderSource = `#version 300 es\n\t#define INFINITY         1000000.0\n\tprecision highp float;\n  precision mediump sampler3D;\n\n  uniform vec3 u_sun_direction;\n  uniform int textureWidth;\n  uniform int textureHeight;\n  uniform int textureDepth;\n  uniform float u_POINT_RADIUS;\n  uniform float u_MIN_DISTANCE;\n  uniform int MAX_STEPS;\n  uniform vec3 gridCellSizes;\n  uniform vec3 origin_offset;\n  uniform sampler3D u_grid;\n  uniform float scaleDown;\n  uniform int pointcloudShading;\n\n  uniform sampler2D u_triangles;\n\tuniform int textureWidthTris;\n\n\tin vec3 a_position;\n\tin vec3 a_normal;\n\n\tout vec4 outColor;\n\n\tvec3 cross1(vec3 a, vec3 b) {\n\t\tvec3 c = vec3(0, 0, 0);\n\t\tc.x = a[1] * b[2] - a[2] * b[1];\n\t\tc.y = a[2] * b[0] - a[0] * b[2];\n\t\tc.z = a[0] * b[1] - a[1] * b[0];\n\t\treturn c;\n\t}\n    \n  bool intersectRaySphere(vec3 rayOrigin, vec3 rayDir, vec3 sphereCenter, float sphereRadius) {\n      vec3 oc = sphereCenter - rayOrigin;\n      float b = dot(oc, rayDir);\n      float c = dot(oc, oc) - b*b;\n      return ((b > 0.)&&(c < sphereRadius * sphereRadius));\n  }\n\n  float TriangleIntersect( vec3 v0, vec3 v1, vec3 v2, vec3 rayOrigin, vec3 rayDirection, int isDoubleSided )\n\t{\n\t\tvec3 edge1 = v1 - v0;\n\t\tvec3 edge2 = v2 - v0;\n\n\t\tvec3 pvec = cross(rayDirection, edge2);\n\n\t\tfloat epsilon = 0.000001; // Add epsilon to avoid division by zero\n\t\tfloat det = dot(edge1, pvec);\n\t\tif (abs(det) < epsilon) // Check if det is too close to zero\n\t\t\treturn INFINITY;\n\n\t\tfloat inv_det = 1.0 / det;\n\t\tif ( isDoubleSided == 0 && det < 0.0 ) \n\t\t\treturn INFINITY;\n\t\t\n\t\tvec3 tvec = rayOrigin - v0;\n\t\tfloat u = dot(tvec, pvec) * inv_det;\n\t\tvec3 qvec = cross(tvec, edge1);\n\t\tfloat v = dot(rayDirection, qvec) * inv_det;\n\t\tfloat t = dot(edge2, qvec) * inv_det;\n\t\tfloat x = dot(pvec,pvec);\n\t\treturn (u < 0.0 || u > 1.0 || v < 0.0 || u + v > 1.0 || t <= 0.0) ? INFINITY : t;\n\t}\n\n\tfloat Calculate_Shading_at_Point_Triangles(vec3 vertex_position, vec3 sun_direction) {\n\t\tfloat d;\n\t\tfloat t = INFINITY;\n\t\tfloat shadow_value = 0.;\n    for (int i = 0; i < ${N_TRIANGLES}; i++) {\n\t\t\tint index = i * 3;\n\t\t\tint x = index % textureWidthTris;\n\t\t\tint y = index / textureWidthTris;\n\t\t\tvec3 v0 = texelFetch(u_triangles, ivec2(x, y), 0).rgb;\n\n\t\t\tindex = i * 3 + 1;\n\t\t\tx = index % textureWidthTris;\n\t\t\ty = index / textureWidthTris;\n\t\t\tvec3 v1 = texelFetch(u_triangles, ivec2(x, y), 0).rgb;\n\n\t\t\tindex = i * 3 + 2;\n\t\t\tx = index % textureWidthTris;\n\t\t\ty = index / textureWidthTris;\n\t\t\tvec3 v2 = texelFetch(u_triangles, ivec2(x, y), 0).rgb;\n\n\t\t\td = TriangleIntersect(v0, v1, v2, vertex_position, sun_direction, 1);\n\t\t\tif (d < t && abs(d)>0.0001) {\n\t\t\t\tshadow_value += 1.;\n\n\t\t}\n\t\t}\n\t\treturn shadow_value;\n\t}\n\n\tfloat Calculate_Shading_at_Point(vec3 vertex_position, vec3 sun_direction) {\n        vec3 ray = normalize(sun_direction);\n        vec3 step = sign(ray);\n        vec3 tMax = (step * (gridCellSizes - mod(vertex_position - origin_offset, gridCellSizes)) + gridCellSizes) / ray;\n        vec3 tDelta = step * gridCellSizes / ray;\n        float shadow_value = 0.;\n        ivec3 gridPos = ivec3((vertex_position - origin_offset) / gridCellSizes);\n        // if ((vertex_position.x < 10.) && (vertex_position.x > -10.) && (vertex_position.y < 10.) && (vertex_position.y > -10.)){\n        //     return true;\n        // }\n        // if (gridPos.x == 0){\n        //     return true;\n        // }\n        for (int i = 0; i < MAX_STEPS; i++) {\n            for (int j = 0; j < textureDepth; j++) {\n                vec4 point = texelFetch(u_grid, ivec3(gridPos.x, gridPos.y, j), 0);\n                vec3 pointPos = point.rgb * scaleDown + origin_offset;\n\n                if (dot(pointPos - vertex_position, pointPos - vertex_position) <= u_MIN_DISTANCE * u_MIN_DISTANCE ){\n                    continue;\n                }\n\n                if (pointPos.z > -10.){\n                    if (intersectRaySphere(vertex_position, ray, pointPos, u_POINT_RADIUS)) {\n                        shadow_value += 1.0;\n                    }\n                }\n                else{\n                  break;\n                }\n            }\n            int axis = (tMax.x < tMax.y) ? 0 : 1;\n            tMax[axis] += tDelta[axis];\n            gridPos[axis] += int(step[axis]);\n            if ((textureWidth <= gridPos.x) || (textureHeight <= gridPos.y) || (gridPos.x < 0) || (gridPos.y < 0)){\n                break;\n            }\n        }\n        return shadow_value;\n    }\n\n\tvoid main() {\n\t\tfloat shadow_value = Calculate_Shading_at_Point_Triangles(a_position.xyz, u_sun_direction);\n    \n    if (pointcloudShading > 0){\n      shadow_value += Calculate_Shading_at_Point(a_position.xyz, u_sun_direction);\n    }\n\t\tfloat intensity = ((shadow_value > 1.)?0.:(1.-shadow_value))*dot(a_normal.xyz, u_sun_direction);\n    intensity = (intensity < 0.)?0.:intensity;\n    outColor = vec4(intensity, intensity, intensity, intensity); // Not shadowed\n\t}`\n\n  // Fragment shader code\n  const fragmentShaderSource = `#version 300 es\n\tprecision highp float;\n\tvoid main() {\n\t}\n\t`\n\n  let max3DTextureSize = gl.getParameter(gl.MAX_3D_TEXTURE_SIZE)\n  console.log(\"Max 3D texture size: \", max3DTextureSize)\n\n  const numLaserPoints = laserPoints != null ? laserPoints.length : 1\n  var textureWidth = 1\n  var textureDepth = 1\n  var textureHeight = 1\n  let texturePointsGrid = new Float32Array(1)\n  var scaleDown = 1\n  var laserPointAreaBounds = []\n  var laserPointZBound = []\n  var laserPointAreaWidth = 0\n  var laserPointAreaHeight = 0\n  var gridCellSize = 0\n\n  if (laserPoints != null) {\n    laserPointAreaBounds = [\n      min_subdim(laserPoints, 0, 3),\n      min_subdim(laserPoints, 1, 3),\n      max_subdim(laserPoints, 0, 3),\n      max_subdim(laserPoints, 1, 3),\n    ]\n    laserPointZBound = [\n      min_subdim(laserPoints, 2, 3),\n      max_subdim(laserPoints, 2, 3),\n    ]\n\n    console.log(laserPointAreaBounds)\n    laserPointAreaWidth = laserPointAreaBounds[2] - laserPointAreaBounds[0]\n    laserPointAreaHeight = laserPointAreaBounds[3] - laserPointAreaBounds[1]\n    gridCellSize = Math.sqrt(\n      (10 * laserPointAreaHeight * laserPointAreaWidth) / numLaserPoints\n    )\n\n    console.log(\"GRID CELL SIZE:\", gridCellSize)\n    textureWidth = Math.ceil(laserPointAreaWidth / gridCellSize)\n    textureHeight = Math.ceil(laserPointAreaHeight / gridCellSize)\n\n    let nPointsGrid = new Int32Array(textureWidth * textureHeight)\n    for (let i = 0; i < laserPoints.length; i += 3) {\n      let x = Math.floor(\n        (laserPoints[i] - laserPointAreaBounds[0]) / gridCellSize\n      )\n      let y = Math.floor(\n        (laserPoints[i + 1] - laserPointAreaBounds[1]) / gridCellSize\n      )\n      let index = (y * textureWidth + x) * 4\n      nPointsGrid[index] += 1\n    }\n    const maxNPoints = max_subdim(nPointsGrid, 0, 1)\n    console.log(`Maximal depth of texture: ${maxNPoints}`)\n    textureDepth = maxNPoints\n\n    texturePointsGrid = new Float32Array(\n      textureWidth * textureHeight * maxNPoints * 4\n    )\n    for (var i = 0; i < texturePointsGrid.length; i++) {\n      texturePointsGrid[i] = -100.0\n    }\n\n    scaleDown =\n      1.2 *\n      Math.max(\n        laserPointZBound[1] - laserPointZBound[0],\n        laserPointAreaHeight,\n        laserPointAreaWidth\n      )\n\n    for (var i = 0; i < laserPoints.length; i += 3) {\n      let x = Math.floor(\n        (laserPoints[i] - laserPointAreaBounds[0]) / gridCellSize\n      )\n      let y = Math.floor(\n        (laserPoints[i + 1] - laserPointAreaBounds[1]) / gridCellSize\n      )\n      for (var j = 0; j < textureDepth; j++) {\n        let index =\n          (y * textureWidth + x + j * textureHeight * textureWidth) * 4\n        if (texturePointsGrid[index + 2] < 0) {\n          texturePointsGrid[index + 0] =\n            (laserPoints[i] - laserPointAreaBounds[0]) / scaleDown\n          texturePointsGrid[index + 1] =\n            (laserPoints[i + 1] - laserPointAreaBounds[1]) / scaleDown\n          texturePointsGrid[index + 2] = (laserPoints[i + 2] - 0) / scaleDown\n          texturePointsGrid[index + 3] = 1\n          break\n        }\n      }\n    }\n  }\n\n  const vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexShaderSource)\n  const fragmentShader = createShader(\n    gl,\n    gl.FRAGMENT_SHADER,\n    fragmentShaderSource\n  )\n\n  const program = createProgram(gl, vertexShader, fragmentShader, [\"outColor\"])\n  if (program === \"abortSimulation\") {\n    return null\n  }\n\n  const colorBuffer = makeBuffer(gl, N_POINTS * 16)\n  const tf = makeTransformFeedback(gl, colorBuffer)\n  // gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);\n  // gl.pixelStorei(gl.PACK_ALIGNMENT, 1);\n\n  var maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE)\n\n  var textureWidthTris = Math.min(\n    3 * N_TRIANGLES,\n    Math.floor(maxTextureSize / 12) * 12\n  )\n  var textureHeightTris = Math.ceil((3 * N_TRIANGLES) / textureWidthTris)\n\n  gl.useProgram(program)\n\n  var alignedTrianglesArray\n  //if (textureHeightTris == 1) {\n  //   alignedTrianglesArray = trianglesArray\n  //} else {\n  alignedTrianglesArray = new Float32Array(\n    textureWidthTris * textureHeightTris * 4\n  )\n\n  for (var i = 0; i < N_TRIANGLES; i++) {\n    var x = (12 * i) % textureWidthTris\n    var y = Math.floor((12 * i) / textureWidthTris)\n    var index = y * textureWidthTris + x\n    for (var j = 0; j < 3; j++) {\n      alignedTrianglesArray[index + j] = trianglesArray[9 * i + j]\n      alignedTrianglesArray[index + j + 4] = trianglesArray[9 * i + j + 3]\n      alignedTrianglesArray[index + j + 8] = trianglesArray[9 * i + j + 6]\n    }\n  }\n  // }\n\n  let textureTri = gl.createTexture()\n  gl.activeTexture(gl.TEXTURE0)\n  gl.bindTexture(gl.TEXTURE_2D, textureTri)\n\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    gl.RGBA32F,\n    textureWidthTris,\n    textureHeightTris,\n    0,\n    gl.RGBA,\n    gl.FLOAT,\n    alignedTrianglesArray\n  )\n\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST)\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST)\n  gl.bindTexture(gl.TEXTURE_2D, null)\n\n  var texture = gl.createTexture()\n  gl.activeTexture(gl.TEXTURE1)\n  gl.bindTexture(gl.TEXTURE_3D, texture)\n  // Upload the buffer to the GPU and configure the 3D texture\n  gl.texImage3D(\n    gl.TEXTURE_3D, // target\n    0, // level\n    gl.RGBA32F, // internalFormat\n    textureWidth, // width\n    textureHeight, // height\n    textureDepth, // depth\n    0, // border\n    gl.RGBA, // format\n    gl.FLOAT, // type\n    texturePointsGrid // pixel data\n  )\n\n  // Set up texture parameters for the 3D texture\n  gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_MIN_FILTER, gl.NEAREST)\n  gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_MAG_FILTER, gl.NEAREST)\n  gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n  gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n  gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_R, gl.CLAMP_TO_EDGE)\n\n  var u_trianglesLocation = gl.getUniformLocation(program, \"u_triangles\")\n  gl.activeTexture(gl.TEXTURE0)\n  gl.bindTexture(gl.TEXTURE_2D, textureTri)\n  gl.uniform1i(u_trianglesLocation, 0)\n\n  var u_pointcloudShading = gl.getUniformLocation(program, \"pointcloudShading\")\n  gl.uniform1i(u_pointcloudShading, laserPoints != null ? 1 : 0)\n\n  var u_textureWidth = gl.getUniformLocation(program, \"textureWidth\")\n  gl.uniform1i(u_textureWidth, textureWidth)\n  var u_textureHeight = gl.getUniformLocation(program, \"textureHeight\")\n  gl.uniform1i(u_textureHeight, textureHeight)\n  var u_textureDepth = gl.getUniformLocation(program, \"textureDepth\")\n  gl.uniform1i(u_textureDepth, textureDepth)\n  var u_POINT_RADIUS = gl.getUniformLocation(program, \"u_POINT_RADIUS\")\n  gl.uniform1f(u_POINT_RADIUS, laserPointsRadius)\n  var u_MIN_DISTANCE = gl.getUniformLocation(program, \"u_MIN_DISTANCE\")\n  gl.uniform1f(u_MIN_DISTANCE, laserPointsMinDistance)\n  var u_scaleDown = gl.getUniformLocation(program, \"scaleDown\")\n  gl.uniform1f(u_scaleDown, scaleDown)\n  var u_MAX_STEPS = gl.getUniformLocation(program, \"MAX_STEPS\")\n  gl.uniform1i(u_MAX_STEPS, 10000)\n  var u_gridCellSizes = gl.getUniformLocation(program, \"gridCellSizes\")\n  gl.uniform3f(u_gridCellSizes, gridCellSize, gridCellSize, 10)\n\n  var u_originOffset = gl.getUniformLocation(program, \"origin_offset\")\n  gl.uniform3f(\n    u_originOffset,\n    laserPointAreaBounds[0],\n    laserPointAreaBounds[1],\n    0\n  )\n\n  var u_gridLocation = gl.getUniformLocation(program, \"u_grid\")\n  gl.activeTexture(gl.TEXTURE1)\n  gl.bindTexture(gl.TEXTURE_3D, texture)\n  gl.uniform1i(u_gridLocation, 1)\n\n  var u_textureWidthTris = gl.getUniformLocation(program, \"textureWidthTris\")\n  gl.uniform1i(u_textureWidthTris, textureWidthTris)\n\n  const positionAttributeLocation = gl.getAttribLocation(program, \"a_position\")\n  const normalAttributeLocation = gl.getAttribLocation(program, \"a_normal\")\n\n  const vao = gl.createVertexArray()\n  gl.bindVertexArray(vao)\n\n  const positionBuffer = makeBufferAndSetAttribute(\n    gl,\n    pointsArray,\n    positionAttributeLocation\n  )\n  const normalBuffer = makeBufferAndSetAttribute(\n    gl,\n    normals,\n    normalAttributeLocation\n  )\n\n  var colorCodedArray = null\n  var isShadowedArray = null\n  for (var i = 0; i < num_dates; i++) {\n    let sunDirectionUniformLocation = gl.getUniformLocation(\n      program,\n      \"u_sun_direction\"\n    )\n\n    let sunDirection = retrieveRandomSunDirections(1, loc.lat, loc.lon)\n    // let sunDirection = new Vector3(0.65, -0.65, 0.1);\n    gl.uniform3fv(sunDirectionUniformLocation, sunDirection)\n\n    drawArraysWithTransformFeedback(gl, tf, gl.POINTS, N_POINTS)\n\n    if (isShadowedArray == null) {\n      colorCodedArray = getResults(gl, colorBuffer, \"shading\", N_POINTS)\n      isShadowedArray = colorCodedArray.filter(\n        (_, index) => (index + 1) % 4 === 0\n      )\n    } else {\n      colorCodedArray = getResults(gl, colorBuffer, \"shading\", N_POINTS)\n      addToArray(\n        isShadowedArray,\n        colorCodedArray.filter((_, index) => (index + 1) % 4 === 0)\n      )\n    }\n  }\n\n  gl.deleteTexture(texture)\n  gl.deleteShader(vertexShader)\n  gl.deleteShader(fragmentShader)\n  gl.deleteProgram(program)\n  gl.deleteBuffer(positionBuffer)\n  gl.deleteBuffer(normalBuffer)\n  gl.deleteTransformFeedback(tf)\n  gl.deleteBuffer(colorBuffer)\n\n  return isShadowedArray\n}\n\nfunction getResults(gl, buffer, label, N_POINTS) {\n  let results = new Float32Array(N_POINTS * 4)\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n  gl.getBufferSubData(\n    gl.ARRAY_BUFFER,\n    0, // byte offset into GPU buffer,\n    results\n  )\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, null) // productBuffer was still bound to ARRAY_BUFFER so unbind it\n  return results\n}\n\nfunction createShader(gl, type, source) {\n  const shader = gl.createShader(type)\n  gl.shaderSource(shader, source)\n  gl.compileShader(shader)\n  const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS)\n  if (success) {\n    return shader\n  }\n  console.error(gl.getShaderInfoLog(shader))\n  gl.deleteShader(shader)\n}\n\nfunction createProgram(\n  gl,\n  vertexShader,\n  fragmentShader,\n  variables_of_interest\n) {\n  const program = gl.createProgram()\n\n  if (vertexShader === undefined || fragmentShader === undefined) {\n    window.setShowTooManyUniformsError(true)\n    return \"abortSimulation\"\n  } else {\n    gl.attachShader(program, vertexShader)\n    gl.attachShader(program, fragmentShader)\n    gl.transformFeedbackVaryings(\n      program,\n      variables_of_interest,\n      gl.SEPARATE_ATTRIBS\n    )\n    gl.linkProgram(program)\n    const success = gl.getProgramParameter(program, gl.LINK_STATUS)\n    if (success) {\n      return program\n    }\n    console.error(gl.getProgramInfoLog(program))\n    gl.deleteProgram(program)\n  }\n}\n\nfunction makeBuffer(gl, sizeOrData) {\n  const buf = gl.createBuffer()\n  gl.bindBuffer(gl.ARRAY_BUFFER, buf)\n  gl.bufferData(gl.ARRAY_BUFFER, sizeOrData, gl.DYNAMIC_DRAW)\n  return buf\n}\n\nfunction makeTransformFeedback(gl, buffer) {\n  const tf = gl.createTransformFeedback()\n  gl.bindTransformFeedback(gl.TRANSFORM_FEEDBACK, tf)\n  gl.bindBufferBase(gl.TRANSFORM_FEEDBACK_BUFFER, 0, buffer)\n  return tf\n}\n\nfunction makeBufferAndSetAttribute(gl, data, loc) {\n  const buf = makeBuffer(gl, data)\n  // setup our attributes to tell WebGL how to pull\n  // the data from the buffer above to the attribute\n  gl.enableVertexAttribArray(loc)\n  gl.vertexAttribPointer(\n    loc,\n    3, // size (num components)\n    gl.FLOAT, // type of data in buffer\n    false, // normalize\n    0, // stride (0 = auto)\n    0 // offset\n  )\n}\n\nfunction drawArraysWithTransformFeedback(gl, tf, primitiveType, count) {\n  // turn of using the fragment shader\n  gl.enable(gl.RASTERIZER_DISCARD)\n\n  gl.bindTransformFeedback(gl.TRANSFORM_FEEDBACK, tf)\n  gl.beginTransformFeedback(gl.POINTS)\n  gl.drawArrays(primitiveType, 0, count)\n  gl.endTransformFeedback()\n  gl.bindTransformFeedback(gl.TRANSFORM_FEEDBACK, null)\n\n  // unbind the buffer from the TRANFORM_FEEDBACK_BUFFER\n  gl.bindBufferBase(gl.TRANSFORM_FEEDBACK_BUFFER, 0, null)\n\n  // turn on using fragment shaders again\n  gl.disable(gl.RASTERIZER_DISCARD)\n}\n","import * as THREE from \"three\"\n\nimport { vec3 } from \"gl-matrix\"\nimport { adaptiveSubdivideMesh } from \"./stl_to_array.js\"\nimport { STLViewer, camera, controls, renderer, scene } from \"./stlviewer.js\"\n// import init, { Session, Input} from \"@webonnx/wonnx-wasm\";\n// import { cumulativeIntensityMesh } from './glmatrix_raytracing/glmatrix_raytracing.js';\nimport SunCalc from \"suncalc\"\nimport { loc_utm } from \"./download.js\"\nimport { intensity_colormap } from \"./utils.js\"\nimport { rayTracingWebGL } from \"./webgl_raytracing.js\"\nimport { rayTracingPointsWebGL } from \"./webgl_raytracing_points.js\"\n//import { triangleIntersectText, Calculate_Shading_at_Point_text } from \"./webgl_raytracing.js\";\nimport DatesSlider from \"../components/PVSimulation/DatesSlider.js\"\n\n// import '@tensorflow/tfjs-backend-webgpu';\n// Set the backend to WebGPU and wait for the module to be ready.\n\n// import { STLViewer } from \"./stlviewer_2/stlviewer.js\";\n\nlet raytracingGeometry\nlet innerGeometry\nlet outerGeometry\nvar intensities = null\n\nexport function getViewer() {\n  return [scene, renderer, camera, controls]\n}\n\nexport function retrieveRandomSunDirections(Ndates, lat, lon) {\n  const directions = new Float32Array(Ndates * 3)\n  var i = 0\n  while (i < Ndates) {\n    const date = new Date(\n      2023,\n      Math.floor(12 * Math.random()),\n      1 + Math.floor(28 * Math.random()),\n      Math.floor(24 * Math.random()),\n      Math.floor(60 * Math.random()),\n      0,\n      0\n    )\n\n    const pos = SunCalc.getPosition(date, lat, lon)\n    if (pos.altitude < 0.1 || pos.altitude == Number.NaN) {\n      continue\n    }\n    directions[3 * i] = -Math.cos(pos.altitude) * Math.sin(pos.azimuth)\n    directions[3 * i + 1] = -Math.cos(pos.altitude) * Math.cos(pos.azimuth)\n    directions[3 * i + 2] = Math.sin(pos.altitude)\n    i += 1\n  }\n  return directions\n}\n\nexport async function calc_webgl(loc, laserPoints, resetCamera) {\n  const mesh_vectors = raytracingGeometry.attributes.position.array\n  const points = innerGeometry.attributes.position.array\n  const normals = innerGeometry.attributes.normal.array\n\n  const status_elem = document.getElementById(\"status\")\n  status_elem.textContent = \"Simulating\"\n  status_elem.hasChanged = true\n\n  let uniquePoints = []\n  let uniqueNormals = []\n\n  // Create an object to hold point/normal pairs, where the key is a string representation of the point\n  const uniquePairs = {}\n\n  for (let i = 0; i < points.length; i += 3) {\n    const point = [points[i], points[i + 1], points[i + 2]].map((value) =>\n      parseFloat(value.toFixed(6))\n    ) // limit precision\n    const pointKey = JSON.stringify(point)\n\n    if (!uniquePairs.hasOwnProperty(pointKey)) {\n      uniquePairs[pointKey] = i / 3\n      uniquePoints.push(points[i], points[i + 1], points[i + 2])\n      uniqueNormals.push(normals[i], normals[i + 1], normals[i + 2])\n    }\n  }\n\n  const uniquePointsArray = new Float32Array(uniquePoints.slice())\n  const uniqueNormalsArray = new Float32Array(uniqueNormals.slice())\n\n  const laserPointsRadius = 0.5\n  const laserPointsMinDistance = 1.0\n\n  // Compute unique intensities\n  const uniqueIntensities = await rayTracingPointsWebGL(\n    uniquePointsArray,\n    mesh_vectors,\n    uniqueNormalsArray,\n    laserPoints,\n    laserPointsRadius,\n    laserPointsMinDistance,\n    window.numSimulations,\n    loc\n  )\n  if (uniqueIntensities === null) {\n    window.setLoading(false)\n    return null\n  }\n  // Store unique intensities in uniquePairs\n  for (let i = 0; i < uniqueIntensities.length; i++) {\n    const point = [\n      uniquePoints[i * 3],\n      uniquePoints[i * 3 + 1],\n      uniquePoints[i * 3 + 2],\n    ].map((value) => parseFloat(value.toFixed(6))) // limit precision\n    const pointKey = JSON.stringify(point)\n\n    if (uniquePairs.hasOwnProperty(pointKey)) {\n      uniquePairs[pointKey] = uniqueIntensities[i]\n    } else {\n      console.error(`Couldn't find indices for pointKey ${pointKey}`)\n    }\n  }\n\n  // Generate final intensities array\n  let intensities_array = new Array(points.length / 3).fill(0)\n\n  for (let i = 0; i < points.length; i += 3) {\n    const point = [points[i], points[i + 1], points[i + 2]].map((value) =>\n      parseFloat(value.toFixed(6))\n    ) // limit precision\n    const pointKey = JSON.stringify(point)\n\n    if (uniquePairs.hasOwnProperty(pointKey)) {\n      intensities_array[i / 3] = uniquePairs[pointKey]\n    }\n  }\n\n  const intensities = new Float32Array(intensities_array)\n\n  status_elem.textContent = \"Simulation Done\"\n  status_elem.hasChanged = true\n  window.setLoading(false)\n  showMeshIntensities(intensities, laserPoints, resetCamera)\n}\n\nfunction refine_triangles(triangle_array, threshold) {\n  const triangles = [\n    [\n      vec3.fromValues(...triangle_array.slice(0, 3)),\n      vec3.fromValues(...triangle_array.slice(3, 6)),\n      vec3.fromValues(...triangle_array.slice(6, 9)),\n    ],\n  ]\n\n  const subdividedTriangles = adaptiveSubdivideMesh(triangles, threshold)\n\n  const newpos_update = []\n  for (const triangle of subdividedTriangles) {\n    newpos_update.push(...triangle)\n  }\n  return newpos_update\n}\n\nfunction centerMesh(geometry, xytranslate, minZ) {\n  // centralize mesh to main point\n  var newMinZ\n\n  if (minZ == null) {\n    newMinZ = Number.POSITIVE_INFINITY\n\n    // Iterate over vertices and find the minimum z value\n    for (var i = 0; i < geometry.attributes.position.array.length; i++) {\n      const zcoord = geometry.attributes.position.getZ(i)\n      if (zcoord < newMinZ) {\n        newMinZ = zcoord\n      }\n    }\n  } else {\n    newMinZ = minZ\n  }\n\n  var posarray = geometry.attributes.position.array\n  for (var i = 0; i < posarray.length; i += 9) {\n    for (var j = 0; j < 9; j += 3) {\n      posarray[i + j] = posarray[i + j] - xytranslate[0]\n      posarray[i + j + 1] = posarray[i + j + 1] - xytranslate[1]\n      posarray[i + j + 2] = posarray[i + j + 2] - newMinZ\n    }\n  }\n  return newMinZ\n}\n\nfunction cutoffMesh(geometry, cutoff) {\n  var posarray = geometry.attributes.position.array.slice()\n  var newposarray = []\n  var newnormals = []\n  for (var i = 0; i < posarray.length; i += 9) {\n    var keep = true\n    for (var j = 0; j < 9; j += 3) {\n      if (\n        posarray[i + j] < -cutoff ||\n        posarray[i + j] > cutoff ||\n        posarray[i + j + 1] < -cutoff ||\n        posarray[i + j + 1] > cutoff\n      ) {\n        keep = false\n      }\n    }\n\n    if (keep) {\n      const v0 = vec3.fromValues(...posarray.slice(i, i + 3))\n      const v1 = vec3.fromValues(...posarray.slice(i + 3, i + 6))\n      const v2 = vec3.fromValues(...posarray.slice(i + 6, i + 9))\n      let d1 = vec3.create()\n      vec3.sub(d1, v1, v0)\n      let d2 = vec3.create()\n      vec3.sub(d2, v2, v0)\n      let ar = vec3.create()\n      vec3.cross(ar, d1, d2)\n      var normal = vec3.create()\n      vec3.scale(normal, ar, 1 / vec3.len(ar))\n\n      //remove triangles with low area for shading\n      if (vec3.len(ar) < 0.05) {\n        continue\n      }\n\n      for (var j = 0; j < 9; j++) {\n        newposarray.push(posarray[i + j])\n        newnormals.push(normal[j % 3])\n      }\n    }\n  }\n\n  let new_geometry = new THREE.BufferGeometry()\n  new_geometry.setAttribute(\n    \"position\",\n    new THREE.BufferAttribute(new Float32Array(newposarray), 3)\n  )\n  new_geometry.setAttribute(\n    \"normal\",\n    new THREE.BufferAttribute(new Float32Array(newnormals), 3)\n  )\n  new_geometry.attributes.position.needsUpdate = true\n  new_geometry.attributes.normal.needsUpdate = true\n  return new_geometry\n}\n\nfunction splitCutoffRefineMesh(\n  geometry,\n  refinementCutoff,\n  outerCutoff,\n  adaptiveSubdivideThreshold = Number.POSITIVE_INFINITY\n) {\n  let geometriesCut = cutoffMesh(geometry, outerCutoff)\n  var posarray = geometriesCut.attributes.position.array.slice()\n\n  var innerPosarray = []\n  var innerNormals = []\n\n  var outerPosarray = []\n  var outerNormals = []\n\n  for (var i = 0; i < posarray.length; i += 9) {\n    var isInnerGeometry = true\n    for (var j = 0; j < 9; j += 3) {\n      if (\n        posarray[i + j] < -refinementCutoff ||\n        posarray[i + j] > refinementCutoff ||\n        posarray[i + j + 1] < -refinementCutoff ||\n        posarray[i + j + 1] > refinementCutoff\n      ) {\n        isInnerGeometry = false\n        // break;\n      }\n    }\n\n    const v0 = vec3.fromValues(...posarray.slice(i, i + 3))\n    const v1 = vec3.fromValues(...posarray.slice(i + 3, i + 6))\n    const v2 = vec3.fromValues(...posarray.slice(i + 6, i + 9))\n    let d1 = vec3.create()\n    vec3.sub(d1, v1, v0)\n    let d2 = vec3.create()\n    vec3.sub(d2, v2, v0)\n    let ar = vec3.create()\n    vec3.cross(ar, d1, d2)\n    var normal = vec3.create()\n    vec3.scale(normal, ar, 1 / vec3.len(ar))\n\n    if (vec3.len(ar) < 0.05) {\n      continue\n    }\n    if (isInnerGeometry) {\n      var triangle_points = refine_triangles(\n        posarray.slice(i, i + 9),\n        adaptiveSubdivideThreshold\n      )\n\n      for (const triangle of triangle_points) {\n        innerPosarray.push(triangle[0])\n        innerPosarray.push(triangle[1])\n        innerPosarray.push(triangle[2])\n        innerNormals.push(normal[0])\n        innerNormals.push(normal[1])\n        innerNormals.push(normal[2])\n      }\n    } else {\n      for (var j = 0; j < 9; j++) {\n        outerPosarray.push(posarray[i + j])\n        outerNormals.push(normal[j % 3])\n      }\n    }\n  }\n\n  let innerGeometry = new THREE.BufferGeometry()\n  innerGeometry.setAttribute(\n    \"position\",\n    new THREE.BufferAttribute(new Float32Array(innerPosarray), 3)\n  )\n  innerGeometry.setAttribute(\n    \"normal\",\n    new THREE.BufferAttribute(new Float32Array(innerNormals), 3)\n  )\n  innerGeometry.attributes.position.needsUpdate = true\n  innerGeometry.attributes.normal.needsUpdate = true\n\n  let outerGeometry = new THREE.BufferGeometry()\n  outerGeometry.setAttribute(\n    \"position\",\n    new THREE.BufferAttribute(new Float32Array(outerPosarray), 3)\n  )\n  outerGeometry.setAttribute(\n    \"normal\",\n    new THREE.BufferAttribute(new Float32Array(outerNormals), 3)\n  )\n  outerGeometry.attributes.position.needsUpdate = true\n  outerGeometry.attributes.normal.needsUpdate = true\n\n  return { innerGeometry: innerGeometry, outerGeometry: outerGeometry }\n}\n\nexport function createMeshes(\n  big_geometry,\n  offset,\n  minZ = null,\n  cutoffRaytracing = window.numRadiusSimulation + 20,\n  outerCutoff = window.numRadiusSimulation + 70,\n  refinementCutoff = window.numRadiusSimulation,\n  mesh_refinement_scale = 2\n) {\n  intensities = null\n  //center the big mesh around the building coordinates from OSM\n  const newMinZ = centerMesh(\n    big_geometry,\n    [loc_utm[0] - offset[0], loc_utm[1] - offset[1]],\n    minZ\n  )\n\n  raytracingGeometry = cutoffMesh(big_geometry, cutoffRaytracing)\n\n  let geometryDict = splitCutoffRefineMesh(\n    big_geometry,\n    refinementCutoff,\n    outerCutoff,\n    mesh_refinement_scale\n  )\n  innerGeometry = geometryDict.innerGeometry\n  outerGeometry = geometryDict.outerGeometry\n\n  if (innerGeometry.attributes.position.array.length === 0) {\n    window.setLoading(false)\n    window.setShowErrorMessage(true)\n    window.setShowThreeViewer(false)\n  }\n  return newMinZ\n}\n\nexport function showMeshOrig() {\n  var elem = document.getElementsByClassName(\"stlviewer\")[0]\n  const newelem = document.createElement(\"div\")\n  newelem.setAttribute(\"class\", \"stlviewer\")\n  elem.replaceWith(newelem)\n  newelem.id = \"webgl-container\"\n  STLViewer(newelem)\n\n  const Npoints = innerGeometry.attributes.position.array.length / 3\n  var newColors = new Float32Array(3 * Npoints)\n  for (var i = 0; i < Npoints; i++) {\n    newColors[3 * i] = 0.6 + 0.4 * Math.random()\n    newColors[3 * i + 1] = 0.4 + 0.3 * Math.random()\n    newColors[3 * i + 2] = 0.3 * Math.random()\n  }\n\n  innerGeometry.setAttribute(\"color\", new THREE.BufferAttribute(newColors, 3))\n  var material = new THREE.MeshStandardMaterial({ vertexColors: true })\n  // var material = new THREE.MeshStandardMaterial({ color: 0xd1bea4 });\n  var mesh = new THREE.Mesh(innerGeometry, material)\n  scene.add(mesh)\n\n  // Compute the middle\n  var middle = new THREE.Vector3()\n  innerGeometry.computeBoundingBox()\n  innerGeometry.boundingBox.getCenter(middle)\n\n  // Center it\n  //mesh.position.x = -1 * middle.x;\n  //mesh.position.y = -1 * middle.y;\n  //mesh.position.z = -1 * middle.z+3;\n\n  // Pull the camera away as needed\n  var largestDimension = Math.max(\n    innerGeometry.boundingBox.max.x,\n    innerGeometry.boundingBox.max.y,\n    innerGeometry.boundingBox.max.z\n  )\n  camera.position.set(0, -20, 100)\n  camera.position.z = 40\n\n  var animate = function () {\n    requestAnimationFrame(animate)\n    controls.update()\n    renderer.render(scene, camera)\n  }\n  animate()\n}\n\nexport async function replot() {\n  showMeshIntensities()\n}\n\nexport async function showMeshIntensities(\n  intensities,\n  laserPoints,\n  resetCamera\n) {\n  var oldCameraPosition\n  if (resetCamera || camera == null) {\n    oldCameraPosition = { x: 0, y: 0, z: 0 }\n  } else {\n    oldCameraPosition = {\n      x: camera.position.x,\n      y: camera.position.y,\n      z: camera.position.z,\n    }\n  }\n\n  STLViewer(resetCamera)\n\n  const Npoints = innerGeometry.attributes.position.array.length / 3\n  var newColors = new Float32Array(Npoints * 3)\n  //var intMax = get99thPercentile(intensities);\n  for (var i = 0; i < Npoints; i++) {\n    const col = intensity_colormap(\n      Math.min(1, intensities[i] / window.numSimulations / 0.6)\n    )\n    //The 0.6 comes from looking at a rooftop facing south with good angle.\n    newColors[3 * i] = col[0]\n    newColors[3 * i + 1] = col[1]\n    newColors[3 * i + 2] = col[2]\n  }\n\n  innerGeometry.setAttribute(\n    \"color\",\n    new THREE.Float32BufferAttribute(newColors, 3)\n  )\n  var material = new THREE.MeshStandardMaterial({\n    vertexColors: true,\n    side: THREE.DoubleSide,\n    shininess: 0,\n    roughness: 1,\n  })\n  // var material = new THREE.MeshStandardMaterial({ color: 0xd1bea4 });\n  var mesh = new THREE.Mesh(innerGeometry, material)\n\n  scene.add(mesh)\n\n  var outerGeometryMaterial = new THREE.MeshStandardMaterial({\n    vertexColors: false,\n    side: THREE.DoubleSide,\n    color: 0xd1bea4,\n    shininess: 0,\n    roughness: 1,\n  })\n  // var material = new THREE.MeshStandardMaterial({ color: 0xd1bea4 });\n  var outerMesh = new THREE.Mesh(outerGeometry, outerGeometryMaterial)\n\n  scene.add(outerMesh)\n\n  // Create and add a sphere for each point\n  if (laserPoints != null) {\n    // Create a geometry for the spheres\n    const sphereGeometry = new THREE.SphereGeometry(0.1) // Adjust the radius as needed\n\n    // Create a material for the spheres\n    const sphereMaterial = new THREE.MeshBasicMaterial({ color: 0x992222 }) // Adjust the color as needed\n\n    for (var i = 0; i < laserPoints.length; i++) {\n      if ((i % 100) / 100 < window.pointsVisualizationRatio) {\n        let point = laserPoints[i]\n        const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial)\n        sphere.position.set(point[0], point[1], point[2])\n        scene.add(sphere)\n      }\n    }\n  }\n  // Compute the middle\n  var middle = new THREE.Vector3()\n  innerGeometry.computeBoundingBox()\n  innerGeometry.boundingBox.getCenter(middle)\n\n  // Pull the camera away as needed\n  // var largestDimension = Math.max(\n  //   innerGeometry.boundingBox.max.x,\n  //   innerGeometry.boundingBox.max.y,\n  //   innerGeometry.boundingBox.max.z\n  // );\n\n  if (resetCamera) {\n    camera.position.set(0, -40, 80)\n  } else {\n    console.log(\"Camera Rot\", window.offsetPos[0], window.offsetPos[1])\n\n    camera.position.set(\n      oldCameraPosition.x - window.offsetPos[0],\n      oldCameraPosition.y - window.offsetPos[1],\n      oldCameraPosition.z\n    )\n    window.offsetPos[0] = 0\n    window.offsetPos[1] = 0\n    // console.log(\"New Camera Pos\", camera.position);\n  }\n\n  var animate = function () {\n    requestAnimationFrame(animate)\n    controls.update()\n    renderer.render(scene, camera)\n  }\n  window.setShowViridisLegend(true)\n  animate()\n}\n","import JSZip from \"jszip\"\nimport proj4 from \"proj4\"\nimport * as BufferGeometryUtils from \"three/addons/utils/BufferGeometryUtils.js\"\nimport { STLLoader } from \"three/examples/jsm/loaders/STLLoader.js\"\nimport { calc_webgl, createMeshes } from \"./pv_simulation\"\nexport var loc_utm\n\nimport { loadLAZ } from \"./lazimport\"\n\n// var state = \"WaitForAddr\"; // States are \"WaitForAddr\", \"AddrDataLoaded\", \"Inspect\"\n\nasync function getLocationFromInput(locationText) {\n  let loc\n  const coordinatePattern = /^[-]?(\\d+(\\.\\d+)?),\\s*[-]?(\\d+(\\.\\d+)?)$/\n\n  // Check if the string matches the coordinate pattern\n  if (coordinatePattern.test(locationText)) {\n    const [latitude, longitude] = locationText\n      .split(\",\")\n      .map((value) => parseFloat(value.trim()))\n\n    // Create the \"loc\" object with latitude and longitude attributes\n    loc = {\n      lat: latitude,\n      lon: longitude,\n    }\n    return loc\n  } else {\n    let url = \"https://nominatim.openstreetmap.org/search?format=json&q=\"\n      .concat(locationText)\n      .concat(\"+Germany+Bavaria\")\n    let response = await fetchLocation(url)\n    if (!response) {\n      let locationTextModified = locationText.split(\" \").join(\"+\")\n      url = \"https://nominatim.openstreetmap.org/search?format=json&q=\".concat(\n        locationTextModified\n      )\n      response = await fetchLocation(url)\n    }\n    return response\n  }\n}\n\nasync function fetchLocation(url) {\n  let loc\n  const statuselem = document.getElementById(\"status\")\n  try {\n    let response = await fetch(url)\n    if (!response.ok) {\n      console.error(\"Check connection to Nominatim geocoder\")\n      statuselem.textContent = \"Connection to Adress Server failed\"\n      throw new Error(\"Request failed with status \" + response.status)\n    }\n\n    let responseData = await response.json()\n    if (responseData.length === 0) {\n      return null\n    }\n\n    loc = responseData[0]\n    return loc\n  } catch (error) {\n    console.error(\"Error:\", error)\n    return null\n  }\n}\n\nexport async function setLocation(inputValue, inputChanged, loc) {\n  let newloc\n  window.mapLocationBaseChanged = true\n  if (inputChanged) {\n    newloc = await getLocationFromInput(inputValue)\n    window.mapLocation = newloc\n  } else {\n    newloc = loc\n  }\n  // console.log(newloc);\n  if (typeof newloc !== \"undefined\" && newloc != null) {\n    retrieveData(newloc, inputChanged)\n  } else {\n    window.setLoading(false)\n    window.setShowThreeViewer(false)\n    window.setShowErrorMessage(true)\n  }\n\n  if (inputChanged) {\n    window.mapLocationChanged = false\n  }\n}\n\nfunction get_utm32(x, y) {\n  const IN_PROJ = \"EPSG:4326\"\n  const OUT_PROJ = \"EPSG:25832\"\n\n  proj4.defs(\"EPSG:25832\", \"+proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs\")\n\n  const transformer = proj4(IN_PROJ, OUT_PROJ)\n\n  const [x_utm32, y_utm32] = transformer.forward([x, y])\n  loc_utm = [x_utm32, y_utm32]\n  return loc_utm\n}\n\nfunction get_file_names(x, y) {\n  const DIVISOR = 2000\n  const BUFFER_ZONE = 100\n  const loc_utm = get_utm32(x, y)\n  const x_utm32 = loc_utm[0]\n  const y_utm32 = loc_utm[1]\n\n  const x_rounded = Math.floor(x_utm32 / DIVISOR) * 2\n  const y_rounded = Math.floor(y_utm32 / DIVISOR) * 2\n\n  const load_tile_left = x_utm32 % DIVISOR < BUFFER_ZONE\n  const load_tile_right = x_utm32 % DIVISOR > DIVISOR - BUFFER_ZONE\n  const load_tile_lower = y_utm32 % DIVISOR < BUFFER_ZONE\n  const load_tile_upper = y_utm32 % DIVISOR > DIVISOR - BUFFER_ZONE\n\n  const file_list = [`${x_rounded}_${y_rounded}.zip`]\n\n  if (load_tile_left) {\n    file_list.push(`${x_rounded - 2}_${y_rounded}.zip`)\n  }\n  if (load_tile_right) {\n    file_list.push(`${x_rounded + 2}_${y_rounded}.zip`)\n  }\n  if (load_tile_lower) {\n    file_list.push(`${x_rounded}_${y_rounded - 2}.zip`)\n  }\n  if (load_tile_upper) {\n    file_list.push(`${x_rounded}_${y_rounded + 2}.zip`)\n  }\n  if (load_tile_left && load_tile_lower) {\n    file_list.push(`${x_rounded - 2}_${y_rounded - 2}.zip`)\n  }\n  if (load_tile_left && load_tile_upper) {\n    file_list.push(`${x_rounded - 2}_${y_rounded + 2}.zip`)\n  }\n  if (load_tile_right && load_tile_lower) {\n    file_list.push(`${x_rounded + 2}_${y_rounded - 2}.zip`)\n  }\n  if (load_tile_right && load_tile_upper) {\n    file_list.push(`${x_rounded + 2}_${y_rounded + 2}.zip`)\n  }\n  return file_list\n}\n\nfunction get_file_names_laz(x, y) {\n  const DIVISOR = 1000\n  const BUFFER_ZONE = 100\n  const loc_utm = get_utm32(x, y)\n  const x_utm32 = loc_utm[0]\n  const y_utm32 = loc_utm[1]\n\n  const x_rounded = Math.floor(x_utm32 / DIVISOR)\n  const y_rounded = Math.floor(y_utm32 / DIVISOR)\n\n  const load_tile_left = x_utm32 % DIVISOR < BUFFER_ZONE\n  const load_tile_right = x_utm32 % DIVISOR > DIVISOR - BUFFER_ZONE\n  const load_tile_lower = y_utm32 % DIVISOR < BUFFER_ZONE\n  const load_tile_upper = y_utm32 % DIVISOR > DIVISOR - BUFFER_ZONE\n\n  const file_list = [`${x_rounded}_${y_rounded}.laz`]\n\n  if (load_tile_left) {\n    file_list.push(`${x_rounded - 2}_${y_rounded}.laz`)\n  }\n  if (load_tile_right) {\n    file_list.push(`${x_rounded + 2}_${y_rounded}.laz`)\n  }\n  if (load_tile_lower) {\n    file_list.push(`${x_rounded}_${y_rounded - 2}.laz`)\n  }\n  if (load_tile_upper) {\n    file_list.push(`${x_rounded}_${y_rounded + 2}.laz`)\n  }\n  if (load_tile_left && load_tile_lower) {\n    file_list.push(`${x_rounded - 2}_${y_rounded - 2}.laz`)\n  }\n  if (load_tile_left && load_tile_upper) {\n    file_list.push(`${x_rounded - 2}_${y_rounded + 2}.laz`)\n  }\n  if (load_tile_right && load_tile_lower) {\n    file_list.push(`${x_rounded + 2}_${y_rounded - 2}.laz`)\n  }\n  if (load_tile_right && load_tile_upper) {\n    file_list.push(`${x_rounded + 2}_${y_rounded + 2}.laz`)\n  }\n  return file_list\n}\n\nfunction getCommentLine(stlData) {\n  // Convert the ArrayBuffer to a Uint8Array\n  var uint8Array = new Uint8Array(stlData)\n\n  // Create an empty array to store the characters\n  var commentChars = []\n\n  // Iterate over the Uint8Array in reverse order\n  for (var i = uint8Array.length - 2; i >= 0; i--) {\n    // Check if the current character is a newline character\n    if (uint8Array[i] === 10 || uint8Array[i] === 13) {\n      // Stop iterating if a newline character is encountered\n      break\n    }\n\n    // Add the current character to the commentChars array\n    commentChars.unshift(String.fromCharCode(uint8Array[i]))\n  }\n\n  // Convert the array of characters to a string\n  var commentLine = commentChars.join(\"\")\n\n  // Remove any leading or trailing whitespace\n  commentLine = commentLine.trim()\n  return commentLine\n}\n\nfunction parseCommentLine(comment) {\n  // Regular expression pattern to match the comment line format\n  var pattern =\n    /^;\\s*offset\\s*(-?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)\\s*(-?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)\\s*(-?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)\\s*$/i\n\n  // Match the comment line against the pattern\n  var match = comment.match(pattern)\n\n  var offset = [0, 0, 0]\n  // Check if the comment line matches the expected format\n  if (match) {\n    // Extract the offsets from the matched groups\n    console.log(\"Matches\", match)\n    offset = [parseFloat(match[1]), parseFloat(match[2]), parseFloat(match[3])]\n\n    // Print the offsets\n    console.log(\"Offsets:\", offset[0], offset[1], offset[2])\n  } else {\n    console.log(\"Invalid comment format\")\n  }\n  return offset\n}\n\nasync function retrieveData(loc, resetCamera = false) {\n  const baseurl = \"https://www.openpv.de/data/\"\n  var filenames = get_file_names(Number(loc.lon), Number(loc.lat))\n  if (filenames.length == 0) {\n    return\n  }\n\n  const status_elem = document.getElementById(\"status\")\n\n  // Create an array to store individual geometries\n  let geometries = []\n  let stlData = null\n  var cached_file_found = false\n  var main_offset = null\n  console.log(\"Location\", loc)\n  const loc_utm32 = get_utm32(Number(loc.lon), Number(loc.lat))\n  // Iterate through all filenames\n  for (const filename of filenames) {\n    let filename_idx\n    if (window.stlFiles != null) {\n      filename_idx = window.stlFiles.indexOf(filename)\n    } else {\n      filename_idx = -1\n    }\n    if (filename_idx != -1) {\n      stlData = window.stlDataCached[filename_idx]\n      cached_file_found = true\n      console.log(\"Use cached file!!\")\n    } else {\n      let url = baseurl + filename\n      cached_file_found = false\n      status_elem.textContent = \"Loading from \" + url\n\n      try {\n        // Download the zipped STL file\n        let response\n        response = await fetch(url)\n        if (!response.ok) {\n          throw new Error(\"Request failed with status \" + response.status)\n        }\n        const zipData = await response.arrayBuffer()\n\n        // Unzip the zipped STL file\n        const zip = new JSZip()\n        await zip.loadAsync(zipData)\n\n        // Get the STL file from the unzipped contents\n        const stlFile = zip.file(Object.keys(zip.files)[0])\n        // Load the STL file\n        stlData = await stlFile.async(\"arraybuffer\")\n        if (window.stlFiles == null) {\n          window.stlFiles = []\n          window.stlDataCached = []\n        }\n        window.stlFiles.push(filename)\n        window.stlDataCached.push(stlData)\n      } catch (error) {\n        window.setLoading(false)\n        window.setShowErrorMessage(true)\n        return\n      }\n    }\n\n    if (stlData) {\n      // Parse the STL data and add the geometry to the geometries array\n      let geometry = new STLLoader().parse(stlData)\n\n      // Create and display the combined mesh\n      const comment = getCommentLine(stlData)\n      var local_offset = parseCommentLine(comment)\n\n      if (main_offset == null) {\n        main_offset = local_offset\n        local_offset = [0, 0, 0]\n      } else {\n        local_offset = [\n          local_offset[0] - main_offset[0],\n          local_offset[1] - main_offset[1],\n          local_offset[2] - main_offset[2],\n        ]\n        geometry.translate(local_offset[0], local_offset[1], local_offset[2])\n      }\n      console.log(\"OFFSETS\", main_offset, local_offset)\n      geometries.push(geometry)\n      // Merge geometries using BufferGeometryUtils\n      const combinedGeometry = BufferGeometryUtils.mergeGeometries(geometries)\n\n      const minZ = createMeshes(combinedGeometry, main_offset)\n      const offsetUTM32 = [loc_utm32[0], loc_utm32[1], minZ + main_offset[2]]\n\n      console.log(\"OffsetUTM32:\", offsetUTM32)\n      let laser_points = null\n      if (window.enableLaserPoints) {\n        laser_points = await loadLAZ(\n          50,\n          offsetUTM32,\n          get_file_names_laz(Number(loc.lon), Number(loc.lat))\n        )\n      }\n      if (laser_points != null) {\n        console.log(`Finished loading points ${laser_points.length}`)\n      }\n\n      //showMeshOrig();\n      calc_webgl(loc, laser_points, resetCamera)\n    } else {\n      console.error(\"STL file not found in ZIP archive\")\n    }\n  }\n}\n","import { createLazPerf } from \"laz-perf\"\n\nexport function parseHeader(arrayBuffer) {\n  if (arrayBuffer.byteLength < 227)\n    throw new Error(\"Invalid arrayBuffer length\")\n\n  const dataView = new DataView(arrayBuffer)\n\n  const pointDataRecordFormat = dataView.getUint8(104) & 0b1111\n  const pointDataRecordLength = dataView.getUint16(105, true)\n  const pointDataOffset = dataView.getUint32(96, true)\n  const pointCount = dataView.getUint32(107, true)\n\n  const scale = [\n    dataView.getFloat64(131, true),\n    dataView.getFloat64(139, true),\n    dataView.getFloat64(147, true),\n  ]\n  const offset = [\n    dataView.getFloat64(155, true),\n    dataView.getFloat64(163, true),\n    dataView.getFloat64(171, true),\n  ]\n  const min = [\n    dataView.getFloat64(187, true),\n    dataView.getFloat64(203, true),\n    dataView.getFloat64(219, true),\n  ]\n  const max = [\n    dataView.getFloat64(179, true),\n    dataView.getFloat64(195, true),\n    dataView.getFloat64(211, true),\n  ]\n  return {\n    pointDataRecordFormat,\n    pointDataRecordLength,\n    pointDataOffset,\n    pointCount,\n    scale,\n    offset,\n    min,\n    max,\n  }\n}\n\n// suggested by ChatGPT\nfunction getInt32(buffer, byteOffset, littleEndian) {\n  const bytes = [\n    buffer[byteOffset],\n    buffer[byteOffset + 1],\n    buffer[byteOffset + 2],\n    buffer[byteOffset + 3],\n  ]\n\n  if (!littleEndian) {\n    bytes.reverse()\n  }\n\n  const sign = bytes[3] & 0x80 ? -1 : 1\n  const value =\n    ((bytes[3] & 0x7f) << 24) | (bytes[2] << 16) | (bytes[1] << 8) | bytes[0]\n\n  return sign * value\n}\n\nexport async function loadLAZ(radius, offsetPos, filenames) {\n  console.log(\"LOADING!!!\")\n  const BUFFERED_POINTS_COUNT = 400000\n  let points = new Float32Array(3 * BUFFERED_POINTS_COUNT) // 1000 points * 3 values per point\n  let pointsIdx = 0\n\n  for (var filename of filenames) {\n    var filenameIdx\n    if (window.lazFiles != null) {\n      filenameIdx = window.lazFiles.indexOf(filename)\n    } else {\n      filenameIdx = -1\n    }\n    var arrayBuffer\n    if (filenameIdx != -1) {\n      arrayBuffer = window.lazCache[filenameIdx]\n    } else {\n      const response = await fetch(`https://www.openpv.de/laser/${filename}`)\n      arrayBuffer = await response.arrayBuffer()\n      if (window.lazFiles == null) {\n        window.lazFiles = []\n        window.lazCache = []\n      }\n      window.lazFiles.push(filename)\n      window.lazCache.push(arrayBuffer)\n    }\n    const fileUint8Array = new Uint8Array(arrayBuffer)\n\n    const {\n      pointDataRecordFormat,\n      pointDataRecordLength,\n      pointDataOffset,\n      pointCount,\n      scale,\n      offset,\n      min,\n      max,\n    } = parseHeader(arrayBuffer)\n\n    console.log(\"Total Point Count: \", pointCount)\n\n    // Create our Emscripten module.\n    const LazPerf = await createLazPerf()\n    const laszip = new LazPerf.LASZip()\n\n    // Allocate our memory in the Emscripten heap: a filePtr buffer for our\n    // compressed content and a single point's worth of bytes for our output.\n    const dataPtr = LazPerf._malloc(pointDataRecordLength)\n    const filePtr = LazPerf._malloc(fileUint8Array.byteLength)\n\n    // Copy our data into the Emscripten heap so we can point at it in getPoint().\n    LazPerf.HEAPU8.set(fileUint8Array, filePtr)\n\n    min[0] -= offsetPos[0]\n    max[0] -= offsetPos[0]\n    min[1] -= offsetPos[1]\n    max[1] -= offsetPos[1]\n    min[2] -= offsetPos[2]\n    max[2] -= offsetPos[2]\n\n    console.log(\"Mesh minmax\", min, max)\n    console.log(\"Offset Pos\", offsetPos)\n\n    const pointbuffer = new Uint8Array(\n      LazPerf.HEAPU8.buffer,\n      LazPerf.HEAPU8.byteOffset,\n      pointDataRecordLength\n    )\n    const dataview = new DataView(\n      pointbuffer.buffer,\n      pointbuffer.byteOffset,\n      pointDataRecordLength\n    )\n\n    console.time(\"LoadingTime\")\n\n    try {\n      laszip.open(filePtr, fileUint8Array.byteLength)\n\n      const heapByteOffset = LazPerf.HEAPU8.byteOffset\n\n      for (let i = 0; i < pointCount; ++i) {\n        laszip.getPoint(dataPtr)\n\n        // Directly access the LazPerf.HEAPU8 buffer without creating intermediary pointbuffer or dataview\n        const baseOffset = heapByteOffset + dataPtr\n\n        // Retrieve values directly from the buffer\n        const x =\n          getInt32(LazPerf.HEAPU8, baseOffset, true) * scale[0] +\n          offset[0] -\n          offsetPos[0]\n        const y =\n          getInt32(LazPerf.HEAPU8, baseOffset + 4, true) * scale[1] +\n          offset[1] -\n          offsetPos[1]\n        const z =\n          getInt32(LazPerf.HEAPU8, baseOffset + 8, true) * scale[2] +\n          offset[2] -\n          offsetPos[2]\n\n        if (x > -radius && x < radius && y > -radius && y < radius) {\n          if (pointsIdx >= points.length) {\n            const newPoints = new Float32Array(points.length * 2) // Double the size\n            newPoints.set(points)\n            points = newPoints\n          }\n          points[pointsIdx++] = x\n          points[pointsIdx++] = y\n          points[pointsIdx++] = z\n        }\n      }\n    } finally {\n      LazPerf._free(filePtr)\n      LazPerf._free(dataPtr)\n      laszip.delete()\n    }\n    console.timeEnd(\"LoadingTime\")\n  }\n  // points.length = pointsIdx;\n  console.log(\"Points loaded\", pointsIdx / 3)\n  points = points.subarray(0, pointsIdx)\n  return points\n}\n","import React from \"react\"\nimport { useTranslation } from \"react-i18next\"\n\nfunction TooManyUniforms() {\n  const { t, i18n } = useTranslation()\n  return (\n    <div style={{ alignItems: \"center\" }}>\n      <p>{t(\"errorMessage.tooManyUniforms\")}</p>\n    </div>\n  )\n}\n\nexport default TooManyUniforms\n","import React from \"react\"\nimport { useTranslation } from \"react-i18next\"\n\nfunction WrongAdress() {\n  const { t, i18n } = useTranslation()\n  return (\n    <div style={{ alignItems: \"center\" }}>\n      <p>{t(\"errorMessage.wrongAdress\")}</p>\n      <img\n        src=\"images/googleMaps.gif\"\n        alt=\"Showing how to get coordinates from Google Maps\"\n        style={{ width: \"100%\", maxWidth: \"500px\" }}\n      />\n    </div>\n  )\n}\n\nexport default WrongAdress\n","import React, { useState } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport DotLoader from \"react-spinners/DotLoader\"\nimport { setLocation } from \"../../simulation/download\"\nimport TooManyUniforms from \"../ErrorMessages/TooManyUniforms\"\nimport WrongAdress from \"../ErrorMessages/WrongAdress\"\n\nconst override = {\n  display: \"block\",\n  margin: \"auto\",\n  borderColor: \"red\",\n}\n\nfunction SearchField() {\n  const [inputValue, setInputValue] = useState(\"\")\n  const [loading, setLoading] = useState(false)\n  const [showErrorMessage, setShowErrorMessage] = useState(false)\n  const [inputChanged, setInputChanged] = useState(false)\n  const { t, i18n } = useTranslation()\n  const [showTooManyUniformsError, setShowTooManyUniformsError] =\n    useState(false)\n  window.setShowErrorMessage = setShowErrorMessage\n  window.setShowTooManyUniformsError = setShowTooManyUniformsError\n  window.setLoading = setLoading\n  const handleSubmit = (event) => {\n    setLoading(!loading)\n    window.setShowViridisLegend(false)\n    event.preventDefault()\n    window.setShowThreeViewer(true)\n    setLocation(inputValue, inputChanged, window.mapLocation)\n    window.numRadiusSimulationChanged = false\n    window.numSimulationsChanged = false\n    window.mapLocationChanged = false\n    setShowErrorMessage(false)\n    setShowTooManyUniformsError(false)\n    setInputChanged(false)\n  }\n  const handleChange = (event) => {\n    if (inputValue != event.target.value) {\n      setInputValue(event.target.value)\n      setInputChanged(true)\n    }\n  }\n\n  return (\n    <>\n      <form\n        onSubmit={handleSubmit}\n        style={{ display: \"flex\", alignItems: \"center\" }}\n        id=\"search-field\"\n      >\n        <input\n          type=\"text\"\n          placeholder={t(\"searchField.placeholder\")}\n          value={inputValue}\n          onChange={handleChange}\n        />\n        <button type=\"submit\">Start</button>\n      </form>\n      {showErrorMessage && <WrongAdress />}\n      {showTooManyUniformsError && <TooManyUniforms />}\n      <DotLoader\n        color=\"MediumAquaMarine\"\n        cssOverride={override}\n        loading={loading}\n        size={60}\n      />\n      {window.enableLaserPoints && loading && (\n        <div style={{ padding: \"30px\" }}>\n          <p style={{ textAlign: \"center\" }}>\n            {t(\"loadingMessage.warningUseLaserpoints\")}\n          </p>\n        </div>\n      )}\n      {!window.enableLaserPoints && loading && (\n        <div style={{ padding: \"30px\" }}>\n          <p style={{ textAlign: \"center\" }}>\n            {t(\"loadingMessage.warningUseNoLaserpoints\")}\n          </p>\n        </div>\n      )}\n    </>\n  )\n}\n\nexport default SearchField\n","import { useEffect, useState } from \"react\"\nimport { Canvas } from \"react-three-fiber\"\nimport * as THREE from \"three\"\nimport { setLocation } from \"../../simulation/download\"\nimport { camera, controls, renderer, scene } from \"../../simulation/stlviewer\"\n\nexport default function ThreeViewer() {\n  const [offsetPosition, setOffsetPosition] = useState([0, 0]) // initial camera position\n  const [loading, setLoading] = useState(false)\n  if (window.offsetPos == null) {\n    window.offsetPos = [0, 0]\n  }\n\n  const addLocationCylinder = (newPos) => {\n    const cylinderHeight = 100\n    const geometry = new THREE.CylinderGeometry(0.25, 0.25, cylinderHeight, 32)\n    const material = new THREE.MeshBasicMaterial({ color: 0x888888 })\n    const cylinder = new THREE.Mesh(geometry, material)\n    cylinder.position.set(newPos[0], newPos[1], cylinderHeight / 2)\n    cylinder.rotation.set(Math.PI / 2, 0, 0)\n    scene.add(cylinder)\n\n    // setTimeout(() => {\n    //   scene.remove(cylinder);\n    //   cylinder.geometry.dispose();\n    //   cylinder.material.dispose();\n    //   renderer.render(scene, camera);\n    // }, 2000);\n\n    // Create a function to gradually reduce the opacity\n    function fade() {\n      if (cylinder.scale.y > 0.1) {\n        // Reduce the scale by a small amount\n        cylinder.scale.y *= 0.95\n        cylinder.position.z = (cylinder.scale.y * cylinderHeight) / 2\n        // Increase the color brightness by a small amount\n        material.color.lerp(new THREE.Color(0xbbbbbb), 0.04) // Bright green\n\n        // renderer.render(scene, camera);\n        // Call this function again after a small delay\n        setTimeout(fade, 20)\n      } else {\n        // Once the opacity reaches 0, remove the cylinder from the scene\n        scene.remove(cylinder)\n\n        // Dispose of the geometry and the material\n        cylinder.geometry.dispose()\n        cylinder.material.dispose()\n      }\n    }\n\n    // Start the fading process\n    fade()\n  }\n\n  const movePosition = (x, y) => {\n    var offset = [0, 0]\n    // console.log(\"MapBaseChanged: \", window.mapLocationBaseChanged);\n    // console.log(\"MapChanged: \", window.mapLocationChanged);\n    if (window.mapLocationBaseChanged) {\n      setOffsetPosition(0, 0)\n      offset = [-offsetPosition[0], -offsetPosition[1]]\n      window.mapLocationBaseChanged = false\n    } else {\n      offset = [0, 0]\n    }\n\n    if (window.mapLocation != null) {\n      const distanceStep = window.distanceStep\n\n      const direction = Math.atan2(camera.rotation.y, camera.rotation.x)\n      const step = {\n        x:\n          x * distanceStep * Math.cos(direction) -\n          y * distanceStep * Math.sin(direction),\n        y:\n          y * distanceStep * Math.cos(direction) +\n          x * distanceStep * Math.sin(direction),\n      }\n      const newPos = [\n        offsetPosition[0] + step.x + offset[0],\n        offsetPosition[1] + step.y + offset[1],\n      ]\n      window.offsetPos = newPos\n      console.log(\"Old offset pos\", window.offsetPos)\n      setOffsetPosition([newPos[0], newPos[1]])\n      const loc = { lon: window.mapLocation.lon, lat: window.mapLocation.lat }\n      var newloc = { lon: parseFloat(loc.lon), lat: parseFloat(loc.lat) }\n      // console.log(direction, step, offset);\n      // console.log(newPos);\n      // console.log(\"Old location: \", newloc.lon, newloc.lat);\n      newloc.lon +=\n        (step.x * 360) / 40000000 / Math.cos((newloc.lat / 180) * Math.PI)\n      newloc.lat += (step.y * 360) / 40000000\n      // console.log(\"Update location: \", loc, newloc);\n      newloc = { lat: newloc.lat.toString(), lon: newloc.lon.toString() }\n      window.mapLocation = newloc\n      window.mapLocationChanged = true\n\n      camera.position.set(\n        camera.position.x + step.x,\n        camera.position.y + step.y,\n        camera.position.z\n      )\n      camera.lookAt(newPos[0], newPos[1], 0)\n      controls.target.set(newPos[0], newPos[1], 0)\n\n      // console.log(\"PostMove Camera Position\", camera.position);\n      // console.log(\"Camera Rot\", camera.rotation);\n\n      var animate = function () {\n        requestAnimationFrame(animate)\n        controls.update()\n        renderer.render(scene, camera)\n      }\n      animate()\n\n      addLocationCylinder(newPos)\n    }\n  }\n\n  const resimulate = () => {\n    setLoading(!loading)\n    window.setShowViridisLegend(false)\n    window.setShowThreeViewer(true)\n    setLocation(\"\", false, window.mapLocation)\n    window.numRadiusSimulationChanged = false\n    window.numSimulationsChanged = false\n    window.mapLocationChanged = false\n    setShowErrorMessage(false)\n    setShowTooManyUniformsError(false)\n  }\n\n  return (\n    <div className=\"viewer-container\" style={{ position: \"relative\" }}>\n      <Canvas className=\"three-viewer\" flat linear></Canvas>\n      <canvas id=\"canvas\" width={0} height={0}></canvas>\n      {window.showViridisLegend && \n        <div style={{ position: 'absolute', left: 0, bottom: 0, margin: '10px' }}>\n          <p style={{ fontSize: '8px' }}>\n            <a href=\"https://geodaten.bayern.de/opengeodata/\">Gebäudedaten</a> der \n            <a href=\"https://www.ldbv.bayern.de/vermessung/bvv.html\"> Bayerischen Vermessungsverwaltung </a> |\n            <a href=\"https://creativecommons.org/licenses/by/4.0/deed.de\">CC BY 4.0</a>\n          </p>\n        \n    </div>\n      }\n      {window.showViridisLegend && (\n        <>\n          <button\n            className=\"arrowButton\"\n            onClick={() => movePosition(0, 1)}\n            style={{ right: \"1em\", bottom: \"2em\" }}\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n              <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"5\"></line>\n              <polyline points=\"5 12 12 5 19 12\"></polyline>\n            </svg>\n          </button>\n          <button\n            className=\"arrowButton\"\n            onClick={() => movePosition(0, -1)}\n            style={{ right: \"1em\", bottom: \"0em\" }}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n              style={{ transform: \"rotate(180deg)\" }}\n            >\n              <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"5\"></line>\n              <polyline points=\"5 12 12 5 19 12\"></polyline>\n            </svg>\n          </button>\n          <button\n            className=\"arrowButton\"\n            onClick={resimulate}\n            style={{ right: \"1em\", bottom: \"1em\" }}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"50\"\n              height=\"50\"\n              viewBox=\"0 0 50 50\"\n            >\n              <polyline\n                points=\"10,25 20,35 40,15\"\n                stroke=\"#000000\"\n                strokeWidth=\"0.5em\"\n                fill=\"none\"\n              />\n            </svg>\n          </button>\n          <button\n            className=\"arrowButton\"\n            onClick={() => movePosition(-1, 0)}\n            style={{ right: \"2em\", bottom: \"1em\" }}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n              style={{ transform: \"rotate(270deg)\" }}\n            >\n              <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"5\"></line>\n              <polyline points=\"5 12 12 5 19 12\"></polyline>\n            </svg>\n          </button>\n          <button\n            className=\"arrowButton\"\n            onClick={() => movePosition(1, 0)}\n            style={{ right: \"0em\", bottom: \"1em\" }}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n              style={{ transform: \"rotate(90deg)\" }}\n            >\n              <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"5\"></line>\n              <polyline points=\"5 12 12 5 19 12\"></polyline>\n            </svg>\n          </button>\n        </>\n      )}\n    </div>\n  )\n}\n","import React from \"react\"\n\nconst ViridisLegend = () => {\n  return (\n    <img\n      src=\"images/viridis_legend.svg\"\n      alt=\"Legend of the viridis colormap\"\n      style={{ opacity: 0.6 }}\n      width=\"100%\"\n    />\n  )\n}\n\nexport default ViridisLegend\n","import React, { useState } from \"react\"\nimport SearchField from \"../components/PVSimulation/SearchField\"\n\nimport ThreeViewer from \"../components/ThreeViewer/ThreeViewer\"\nimport ViridisLegend from \"../components/ThreeViewer/ViridisLegend\"\nimport Main from \"../layouts/Main\"\n\nfunction Index() {\n  const [showThreeViewer, setShowThreeViewer] = useState(true)\n  const [showViridisLegend, setShowViridisLegend] = useState(false)\n  window.setShowThreeViewer = setShowThreeViewer\n  window.setShowViridisLegend = setShowViridisLegend\n  window.showViridisLegend = showViridisLegend\n  return (\n    <Main description={\"Berechne das Potential deiner Solaranlage.\"}>\n      <article className=\"post\" id=\"index\">\n        <header>\n          <div className=\"title\">\n            <SearchField />\n          </div>\n        </header>\n        {showThreeViewer && <ThreeViewer />}\n        {showViridisLegend && <ViridisLegend />}\n      </article>\n    </Main>\n  )\n}\n\nexport default Index\n"],"names":["subdivideTriangle","triangle","_triangle","_slicedToArray","v0","v1","v2","m01","vec3","m12","m20","adaptiveSubdivideMesh","triangles","threshold","_step","subdividedTrianglesList","_iterator","_createForOfIteratorHelper","s","n","done","trianglesToSubdivide","value","length","currentTriangle","pop","edge1","edge2","crossProduct","lengthEdge1","lengthEdge2","area","Math","max","push","subdividedTriangles","apply","_toConsumableArray","err","e","f","scene","renderer","camera","controls","STLViewer","resetCamera","arguments","undefined","elem","document","getElementsByClassName","style","width","height","THREE","antialias","alpha","clientWidth","clientHeight","up","setSize","replaceChild","domElement","firstChild","window","addEventListener","aspect","updateProjectionMatrix","MapControls","mouseButtons","LEFT","PAN","MIDDLE","DOLLY","RIGHT","ROTATE","screenSpacePanning","maxPolarAngle","PI","dirLight","position","set","add","dirLight2","dirLight3","addToArray","ar1","ar2","i","intensity_colormap","t","c0","c1","c2","c3","c4","c5","c6","max_subdim","array","offset","iterate","min_subdim","min","rayTracingPointsWebGL","pointsArray","trianglesArray","normals","laserPoints","laserPointsRadius","laserPointsMinDistance","num_dates","loc","N_TRIANGLES","N_POINTS","gl","getElementById","getContext","alert","vertexShaderSource","concat","max3DTextureSize","getParameter","MAX_3D_TEXTURE_SIZE","console","log","numLaserPoints","textureWidth","textureDepth","textureHeight","texturePointsGrid","Float32Array","scaleDown","laserPointAreaBounds","laserPointZBound","laserPointAreaWidth","laserPointAreaHeight","gridCellSize","sqrt","ceil","nPointsGrid","Int32Array","x","floor","maxNPoints","y","j","index","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","variables_of_interest","createProgram","setShowTooManyUniformsError","attachShader","transformFeedbackVaryings","SEPARATE_ATTRIBS","linkProgram","getProgramParameter","LINK_STATUS","error","getProgramInfoLog","deleteProgram","alignedTrianglesArray","colorBuffer","makeBuffer","tf","buffer","createTransformFeedback","bindTransformFeedback","TRANSFORM_FEEDBACK","bindBufferBase","TRANSFORM_FEEDBACK_BUFFER","makeTransformFeedback","maxTextureSize","MAX_TEXTURE_SIZE","textureWidthTris","textureHeightTris","useProgram","textureTri","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","texImage2D","RGBA32F","RGBA","FLOAT","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","texture","TEXTURE1","TEXTURE_3D","texImage3D","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_WRAP_R","u_trianglesLocation","getUniformLocation","uniform1i","u_pointcloudShading","u_textureWidth","u_textureHeight","u_textureDepth","u_POINT_RADIUS","uniform1f","u_MIN_DISTANCE","u_scaleDown","u_MAX_STEPS","u_gridCellSizes","uniform3f","u_originOffset","u_gridLocation","u_textureWidthTris","positionAttributeLocation","getAttribLocation","normalAttributeLocation","vao","createVertexArray","bindVertexArray","positionBuffer","makeBufferAndSetAttribute","normalBuffer","isShadowedArray","sunDirectionUniformLocation","sunDirection","retrieveRandomSunDirections","lat","lon","uniform3fv","drawArraysWithTransformFeedback","POINTS","getResults","filter","_","deleteTexture","deleteShader","deleteBuffer","deleteTransformFeedback","label","results","bindBuffer","ARRAY_BUFFER","getBufferSubData","type","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","sizeOrData","buf","createBuffer","bufferData","DYNAMIC_DRAW","data","enableVertexAttribArray","vertexAttribPointer","primitiveType","count","enable","RASTERIZER_DISCARD","beginTransformFeedback","drawArrays","endTransformFeedback","disable","raytracingGeometry","innerGeometry","outerGeometry","Ndates","directions","date","Date","random","pos","SunCalc","altitude","Number","NaN","cos","sin","azimuth","calc_webgl","_x","_x2","_x3","_calc_webgl","_asyncToGenerator","_regeneratorRuntime","mark","_callee","mesh_vectors","points","status_elem","uniquePoints","uniqueNormals","uniquePairs","point","pointKey","uniquePointsArray","uniqueNormalsArray","uniqueIntensities","_i","_point","_pointKey","intensities_array","_i2","_point2","_pointKey2","intensities","wrap","_context","prev","next","attributes","normal","textContent","hasChanged","map","parseFloat","toFixed","JSON","stringify","hasOwnProperty","slice","numSimulations","sent","setLoading","abrupt","Array","fill","showMeshIntensities","stop","refine_triangles","triangle_array","newpos_update","cutoffMesh","geometry","cutoff","posarray","newposarray","newnormals","keep","d1","d2","ar","new_geometry","setAttribute","needsUpdate","createMeshes","big_geometry","minZ","cutoffRaytracing","numRadiusSimulation","outerCutoff","refinementCutoff","mesh_refinement_scale","newMinZ","xytranslate","POSITIVE_INFINITY","zcoord","getZ","centerMesh","loc_utm","geometryDict","adaptiveSubdivideThreshold","innerPosarray","innerNormals","outerPosarray","outerNormals","isInnerGeometry","_step2","triangle_points","_iterator2","splitCutoffRefineMesh","setShowErrorMessage","setShowThreeViewer","_x4","_x5","_x6","_showMeshIntensities","_callee3","oldCameraPosition","Npoints","newColors","col","material","mesh","outerGeometryMaterial","outerMesh","sphereGeometry","sphereMaterial","sphere","middle","animate","_context3","z","vertexColors","side","shininess","roughness","color","pointsVisualizationRatio","computeBoundingBox","boundingBox","getCenter","offsetPos","requestAnimationFrame","update","render","setShowViridisLegend","parseHeader","arrayBuffer","byteLength","Error","dataView","DataView","pointDataRecordFormat","getUint8","pointDataRecordLength","getUint16","pointDataOffset","getUint32","pointCount","scale","getFloat64","getInt32","byteOffset","littleEndian","bytes","reverse","loadLAZ","_loadLAZ","radius","filenames","pointsIdx","filename","filenameIdx","response","fileUint8Array","_parseHeader","LazPerf","laszip","dataPtr","filePtr","pointbuffer","heapByteOffset","baseOffset","newPoints","lazFiles","indexOf","lazCache","fetch","Uint8Array","createLazPerf","LASZip","_malloc","HEAPU8","time","open","getPoint","_free","delete","timeEnd","t0","finish","subarray","getLocationFromInput","_getLocationFromInput","locationText","_locationText$split$m","_locationText$split$m2","latitude","longitude","url","locationTextModified","test","split","trim","fetchLocation","join","_fetchLocation","_callee2","statuselem","responseData","_context2","ok","status","json","setLocation","_setLocation","inputValue","inputChanged","newloc","mapLocationBaseChanged","mapLocation","retrieveData","mapLocationChanged","get_utm32","proj4","defs","_transformer$forward","forward","_transformer$forward2","x_utm32","y_utm32","get_file_names","DIVISOR","BUFFER_ZONE","x_rounded","y_rounded","load_tile_left","load_tile_right","load_tile_lower","load_tile_upper","file_list","get_file_names_laz","getCommentLine","stlData","uint8Array","commentChars","unshift","String","fromCharCode","commentLine","parseCommentLine","comment","match","_retrieveData","_callee4","baseurl","geometries","main_offset","loc_utm32","filename_idx","zipData","zip","stlFile","local_offset","combinedGeometry","offsetUTM32","laser_points","_args4","_context4","stlFiles","stlDataCached","JSZip","loadAsync","file","Object","keys","files","async","STLLoader","parse","translate","BufferGeometryUtils","enableLaserPoints","t1","_useTranslation","useTranslation","i18n","_jsx","alignItems","children","_jsxs","src","alt","maxWidth","override","display","margin","borderColor","_useState","useState","_useState2","setInputValue","_useState3","_useState4","loading","_useState5","_useState6","showErrorMessage","_useState7","_useState8","setInputChanged","_useState9","_useState10","showTooManyUniformsError","_Fragment","onSubmit","event","preventDefault","numRadiusSimulationChanged","numSimulationsChanged","id","placeholder","onChange","target","WrongAdress","TooManyUniforms","DotLoader","cssOverride","size","padding","textAlign","ThreeViewer","offsetPosition","setOffsetPosition","movePosition","distanceStep","direction","atan2","rotation","step","newPos","toString","lookAt","cylinder","cylinderHeight","fade","lerp","setTimeout","remove","dispose","addLocationCylinder","className","Canvas","flat","linear","showViridisLegend","left","bottom","fontSize","href","onClick","right","xmlns","viewBox","x1","y1","x2","y2","transform","stroke","strokeWidth","opacity","showThreeViewer","Main","description","SearchField","ViridisLegend"],"sourceRoot":""}